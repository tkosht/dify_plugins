identity:
  name: sharepoint_list_list_items
  author: tkosht
  label:
    en_US: List Items
    ja_JP: リストアイテム一覧
description:
  human:
    en_US: List SharePoint list items with optional filters and pagination (ordered by createdDateTime desc).
    ja_JP: フィルタやページネーションを指定して SharePoint リストのアイテムを一覧取得します（createdDateTime desc 固定）。
  llm: List SharePoint list items with optional filters and pagination (createdDateTime desc).
parameters:
  - name: list_url
    type: string
    required: true
    label:
      en_US: List URL
      ja_JP: リストURL
    human_description:
      en_US: "SharePoint list URL (e.g., https://contoso.sharepoint.com/sites/demo/Lists/MyList/AllItems.aspx)"
      ja_JP: "SharePoint リストの URL（例: https://contoso.sharepoint.com/sites/demo/Lists/MyList/AllItems.aspx）"
    llm_description: "SharePoint list URL (AllItems.aspx)"
    form: llm
  - name: select_fields
    type: string
    required: false
    label:
      en_US: Select Fields (comma separated)
      ja_JP: 取得フィールド（カンマ区切り）
    human_description:
      en_US: "Comma separated field internal names or display names to return. Example: Title,Status"
      ja_JP: "返したいフィールドの内部名または表示名をカンマ区切りで指定。例: Title,ステータス"
    llm_description: "Comma separated internal or display names of fields to return"
    form: llm
  - name: page_size
    type: number
    required: false
    label:
      en_US: Page Size
      ja_JP: 1ページ件数
    human_description:
      en_US: Number of items per page (default 20, max 100).
      ja_JP: 1ページあたり件数（デフォルト20、最大100）。
    form: llm
  - name: page_token
    type: string
    required: false
    label:
      en_US: Page Token
      ja_JP: ページトークン
    human_description:
      en_US: Use the token from previous response to fetch next page.
      ja_JP: 前回レスポンスで返されたトークンで次ページを取得します。
    form: llm
  - name: filters
    type: string
    required: false
    label:
      en_US: Filters (JSON)
      ja_JP: フィルタ（JSON）
    human_description:
      en_US: |
        Provide filters as a JSON array of objects or a single JSON object.
        Keys: field / op / value / type. Use "op" (not "operator").
        field accepts display name or internal name (case-insensitive for list fields).
        Note: use exact "createdDateTime" casing for top-level filters.
        Example (array):
        [
          {"field": "Status", "op": "eq", "value": "InProgress"},
          {"field": "createdDateTime", "op": "ge", "value": "2025-12-15T00:00:00Z", "type": "datetime"},
          {"field": "Priority", "op": "ge", "value": 3, "type": "number"}
        ]
        Example (single object):
        {"field": "Status", "op": "eq", "value": "Active"}
        Note: Use indexed columns for server-side filters to avoid 400 errors.
      ja_JP: |
        フィルタ条件は JSON 配列または単一の JSON オブジェクトで指定できます。
        キーは field / op / value / type です（"operator" ではなく "op" を使用）。
        field は表示名または内部名（リスト列は大文字小文字を無視）を指定します。
        備考: トップレベルの createdDateTime は大文字小文字を含めて厳密一致です。
        例（配列）:
        [
          {"field": "ステータス", "op": "eq", "value": "処理中"},
          {"field": "createdDateTime", "op": "ge", "value": "2025-12-15T00:00:00Z", "type": "datetime"},
          {"field": "優先度", "op": "ge", "value": 3, "type": "number"}
        ]
        例（単一オブジェクト）:
        {"field": "ステータス", "op": "eq", "value": "処理中"}
        備考: サーバーフィルタにはインデックス済み列を推奨（未インデックスだと 400 になる場合があります）。
    llm_description: |
      Filters JSON string (array or object). Each entry must have: field, op, value, optional type (string|number|bool|datetime).
      field can be a display name or internal name (case-insensitive for list fields); use exact "createdDateTime" casing. Use "op" (not "operator").
      Note: For list date columns (fields/<name>), type=datetime is treated as a quoted string.
      Example:
      [{"field":"ステータス","op":"eq","value":"処理中"},{"field":"登録日時","op":"gt","value":"2025-12-16T15:00:00Z","type":"datetime"}]
    form: llm
extra:
  python:
    source: tools/list_items.py
