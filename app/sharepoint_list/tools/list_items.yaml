identity:
  name: sharepoint_list_list_items
  author: tkosht
  label:
    en_US: List Items
    ja_JP: リストアイテム一覧
description:
  human:
    en_US: List SharePoint list items with optional filters and pagination
    ja_JP: フィルタやページネーションを指定して SharePoint リストのアイテムを一覧取得します
  llm: List SharePoint list items with optional filters and pagination
parameters:
  - name: site_identifier
    type: string
    required: true
    label:
      en_US: Site Identifier
      ja_JP: サイト指定
    human_description:
      en_US: "Site URL or site ID. URL is recommended. Example: https://contoso.sharepoint.com/sites/demo"
      ja_JP: "サイトURLまたはサイトID。URL推奨。例: https://contoso.sharepoint.com/sites/demo"
    llm_description: Site URL or site ID
    form: llm
  - name: list_identifier
    type: string
    required: true
    label:
      en_US: List Identifier
      ja_JP: リスト指定
    human_description:
      en_US: "List ID (GUID) or list display name."
      ja_JP: "リストID（GUID）またはリスト表示名。"
    llm_description: List ID or display name
    form: llm
  - name: select_fields
    type: string
    required: false
    label:
      en_US: Select Fields (comma separated)
      ja_JP: 取得フィールド（カンマ区切り）
    human_description:
      en_US: "Comma separated field internal names or display names to return. Example: Title,Status"
      ja_JP: "返したいフィールドの内部名または表示名をカンマ区切りで指定。例: Title,ステータス"
    llm_description: "Comma separated internal or display names of fields to return"
    form: llm
  - name: page_size
    type: number
    required: false
    label:
      en_US: Page Size
      ja_JP: 1ページ件数
    human_description:
      en_US: Number of items per page (default 20, max 100).
      ja_JP: 1ページあたり件数（デフォルト20、最大100）。
    form: llm
  - name: page_token
    type: string
    required: false
    label:
      en_US: Page Token
      ja_JP: ページトークン
    human_description:
      en_US: Use the token from previous response to fetch next page.
      ja_JP: 前回レスポンスで返されたトークンで次ページを取得します。
    form: llm
  - name: filters
    type: string
    required: false
    label:
      en_US: Filters (JSON array)
      ja_JP: フィルタ（JSON配列）
    human_description:
      en_US: |
        Provide filters as a JSON array of objects.
        Example:
        [
          {"field": "Status", "op": "eq", "value": "InProgress"},
          {"field": "Priority", "op": "ge", "value": 3},
          {"field": "createdDateTime", "op": "ge", "value": "2025-12-15T00:00:00Z"}
        ]
        Note: Use indexed columns for server-side filters to avoid 400 errors.
      ja_JP: |
        フィルタ条件は JSON 配列で指定してください。
        例:
        [
          {"field": "ステータス", "op": "eq", "value": "処理中"},
          {"field": "優先度", "op": "ge", "value": 3},
          {"field": "createdDateTime", "op": "ge", "value": "2025-12-15T00:00:00Z"}
        ]
        備考: サーバーフィルタにはインデックス済み列を推奨（未インデックスだと 400 になる場合があります）。
    llm_description: "Filters in JSON array format. See human description for example."
    form: llm
  - name: created_after
    type: string
    required: false
    label:
      en_US: Created After (ISO8601)
      ja_JP: 作成日時以降 (ISO8601)
    human_description:
      en_US: "Filter items created at or after this timestamp (e.g., 2025-12-15T00:00:00Z)"
      ja_JP: "この日時以降に作成されたアイテムに絞り込み（例: 2025-12-15T00:00:00Z）"
    form: llm
  - name: created_before
    type: string
    required: false
    label:
      en_US: Created Before (ISO8601)
      ja_JP: 作成日時以前 (ISO8601)
    human_description:
      en_US: "Filter items created at or before this timestamp."
      ja_JP: "この日時以前に作成されたアイテムに絞り込み。"
    form: llm
extra:
  python:
    source: tools/list_items.py
