{"timestamp":"2025-12-22T04:57:32.899Z","type":"session_meta","payload":{"id":"019b446b-79e0-7773-9878-7e44796722f8","timestamp":"2025-12-22T04:57:32.896Z","cwd":"/home/devuser/workspace","originator":"codex_exec","cli_version":"0.77.0","instructions":"# AGENTS.md (and GEMINI.md, CLAUDE.md) - AI Agent Mandatory Protocol\n\n**ğŸ¤– IMPORTANT: This is an AI AGENT-ONLY knowledge base. Human operators should NOT attempt to read or reference these files due to volume and AI-optimized formatting.**\n\nThis file contains MANDATORY protocols for Claude/Gemini Code or Claude/Gemini Agent. ALL rules must be followed without exception.\n\nCommunication with users is in Japanese.\n\n## ğŸš¨ ABSOLUTE MANDATORY RULES (çµ¶å¯¾éµå®ˆ - NO EXCEPTIONS)\n\n### 0ï¸âƒ£ PRE-TASK KNOWLEDGE PROTOCOL (ã‚¿ã‚¹ã‚¯å‰ãƒ—ãƒ­ãƒ¼ãƒ–æ–¹é‡)\n```bash\n# DEFAULT: Microâ€‘Probe è‡ªå‹•å®Ÿè¡Œï¼ˆ<=200msï¼‰ / Deepã¯æ—¢å®šã§å®Ÿæ–½ã—ãªã„\n# ESCALATION: Microã§ä¸è¶³ãŒå®¢è¦³åˆ¤å®šã•ã‚Œã‚‹å ´åˆã®ã¿ Fastâ€‘Probeï¼ˆ<=800msï¼‰ã«è‡ªå‹•æ˜‡æ ¼\n# EXTERNAL: Cognee/WebSearch ç­‰ã®å¤–éƒ¨ã‚¢ã‚¯ã‚»ã‚¹ã¯æ˜ç¤ºä¾é ¼ãŒã‚ã‚‹å ´åˆã®ã¿\n\n# ğŸš¨ APPLIES TO ALL CONTEXTS\n# - ä¼šè©±é–‹å§‹ / /command å®Ÿè¡Œ / ã‚¿ã‚¹ã‚¯ç¶™ç¶š ã„ãšã‚Œã‚‚å…±é€š\n\n# å®Ÿè£…æ‰‹æ®µï¼ˆãƒ­ãƒ¼ã‚«ãƒ«ã®ã¿ãƒ»ãƒ„ãƒ¼ãƒ«å›ºå®šï¼‰\n# - ä½¿ç”¨å¯èƒ½ã‚³ãƒãƒ³ãƒ‰: rg / fdfind / eza\n# - å‡ºåŠ›ã¯ã€Œãƒ‘ã‚¹ + è¦‹å‡ºã—ã€ã®ã¿ï¼ˆæœ¬æ–‡ã®åºƒç¯„å±•é–‹ã¯ç¦æ­¢ï¼‰\n\nMICRO_PROBE_SPEC=(\n  \"Auto-run at task start (<=200ms)\"\n  \"Use only local tools: rg, fdfind, eza\"\n  \"Output: file paths and headings only\"\n)\n\nFAST_PROBE_SPEC=(\n  \"Escalate only if (a) Microã§ãƒ’ãƒƒãƒˆ>0 ã‚‚ã—ãã¯ (b) ç›´æ¥æ¤œç´¢ãŒä¸ç¢ºå®Ÿï¼ˆ0ä»¶ or >50ä»¶ï¼‰\"\n  \"Time budget <=800ms\"\n  \"Still local only; no network\"\n)\n\nMCP_POLICY=(\n  \"Serena: æ—¢å®šã§ä½¿ç”¨ï¼ˆã‚³ãƒ¼ãƒ‰/ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆæ“ä½œå…¨èˆ¬ï¼‰ã€‚çŸ¥è­˜ãƒ­ãƒ¼ãƒ‰ä¸è¦\"\n  \"Cognee: æ—¢å®šOFFã€‚ãƒ¦ãƒ¼ã‚¶ãƒ¼æ˜ç¤ºä¾é ¼æ™‚ã®ã¿å€‹åˆ¥ã«å®Ÿè¡Œï¼ˆæ™‚é–“ä¸Šé™ãƒ»å›æ•°åˆæ„ï¼‰\"\n)\n\nENFORCEMENT=(\n  \"DEEP_LOAD_DEFAULT_OFF=1  # Deep/å¤–éƒ¨ã®è‡ªå‹•å®Ÿè¡Œã¯ç¦æ­¢\"\n  \"EXTERNAL_NETWORK_DEFAULT_OFF=1  # ãƒãƒƒãƒˆãƒ¯ãƒ¼ã‚¯ã¯æ˜ç¤ºè¨±å¯ãŒã‚ã‚‹å ´åˆã®ã¿\"\n)\n```\n\n### 1ï¸âƒ£ MANDATORY RULES VERIFICATION (å¿…é ˆãƒ«ãƒ¼ãƒ«æ¤œè¨¼çµ¶å¯¾)\n```bash\n# MANDATORY RULES CHECKLIST DISPLAY (å¿…é ˆãƒ«ãƒ¼ãƒ«ç¾¤ãƒã‚§ãƒƒã‚¯ãƒªã‚¹ãƒˆè¡¨ç¤º)\n# ğŸ“‹ QUICK ACCESS TOOLS AVAILABLE:\n#   â€¢ show_rules - Interactive mandatory rules checklist\n#   â€¢ full_rules - Complete mandatory rules documentation\n#   â€¢ rules_summary - Quick 10-point summary\n#   â€¢ new_task_checklist [name] - Create task-specific checklist\n# ğŸ“š SETUP: source /home/devuser/workspace/scripts/mandatory_rules_quick_access.sh\n\nfunction display_mandatory_rules_checklist() {\n    echo \"ğŸš¨ MANDATORY RULES VERIFICATION CHECKLIST\"\n    echo \"=========================================\"\n    echo \"â–¡ 0ï¸âƒ£ MICRO PROBE: 200msä»¥å†…ã®è‡ªå‹•ãƒ—ãƒ­ãƒ¼ãƒ–å®Ÿæ–½\"\n    echo \"â–¡ 1ï¸âƒ£ SECURITY ABSOLUTE: No secrets/credentials exposure\"\n    echo \"â–¡ 2ï¸âƒ£ VALUE ASSESSMENT: 5-point evaluation completed\"  \n    echo \"â–¡ 3ï¸âƒ£ CORE PRINCIPLES: Excellence mindset maintained\"\n    echo \"â–¡ 4ï¸âƒ£ WORK MANAGEMENT: Feature branch verification\"\n    echo \"â–¡ 5ï¸âƒ£ KNOWLEDGE ACCESS: ãƒ­ãƒ¼ã‚«ãƒ«Micro/Fastã®ã¿ã€‚Cognee/Webã¯æ˜ç¤ºæ™‚ã®ã¿\"\n    echo \"â–¡ 6ï¸âƒ£ AI-OPTIMIZED FORMAT: Structured knowledge recording\"\n    echo \"â–¡ 7ï¸âƒ£ CHECKLIST-DRIVEN: CDTE framework applied when applicable\"\n    echo \"â–¡ 8ï¸âƒ£ NO MOCKS: Real API calls only - NO mocking in tests\"\n    echo \"â–¡ 9ï¸âƒ£ WEB RESEARCH: Unknown items researched via WebSearch\"\n    echo \"â–¡ ğŸ”Ÿ FACT-BASED: No speculation, verified facts only\"\n    echo \"\"\n    echo \"ğŸ“š MANDATORY REFERENCES:\"\n    echo \"   â€¢ memory-bank/00-core/*mandatory*.md\"\n    echo \"   â€¢ memory-bank/00-core/mandatory_rules_checklist.md (FULL CHECKLIST)\"\n    echo \"   â€¢ memory-bank/11-checklist-driven/checklist_driven_execution_framework.md\"\n    echo \"   â€¢ memory-bank/02-organization/tmux_organization_success_patterns.md (for tmux activities)\"\n    echo \"\"\n    echo \"âš ï¸ REMINDER: Commands (/command) ALSO require knowledge loading!\"\n    echo \"\"\n    read -p \"â“ Confirm ALL mandatory rules verified before starting task (y/N): \" confirmation\n    [[ \"$confirmation\" != \"y\" && \"$confirmation\" != \"Y\" ]] && return 1\n    echo \"âœ… MANDATORY RULES VERIFICATION COMPLETED\"\n    return 0\n}\n```\n\n### 2ï¸âƒ£ SECURITY ABSOLUTE (ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£çµ¶å¯¾)\n```bash\n# AUTO-STOP TRIGGERS\nSECURITY_FORBIDDEN=(\"env.*API\" \"cat.*key\" \"echo.*token\" \"grep.*secret\" \"printenv.*KEY\" \"cat .env\" \"export.*SECRET\")\n# Detection = Immediate termination\n```\n\n### 3ï¸âƒ£ VALUE ASSESSMENT MANDATORY (ä¾¡å€¤è©•ä¾¡å¿…é ˆ)\n```bash\n# 5-POINT EVALUATION (BEFORE EVERY ACTION)\nBEFORE_ACTION_CHECKLIST=(\n    \"0. SECURITY: Exposes secrets/credentials? â†’ STOP\"\n    \"1. USER VALUE: Serves USER not convenience? â†’ VERIFY\"\n    \"2. LONG-TERM: Sustainable not quick-fix? â†’ CONFIRM\"\n    \"3. FACT-BASED: Verified not speculation? â†’ CHECK\"\n    \"4. KNOWLEDGE: Related rules loaded? â†’ MANDATORY\"\n    \"5. ALTERNATIVES: Better approach exists? â†’ EVALUATE\"\n)\n```\n\n### 4ï¸âƒ£ CORE OPERATING PRINCIPLES (åŸºæœ¬å‹•ä½œåŸå‰‡)\n```bash\n# MINDSET (çµ¶å¯¾éµå®ˆ)\nEXCELLENCE_MINDSET=(\"User benefit ALWAYS first\" \"Long-term value PRIORITY\" \"Lazy solutions FORBIDDEN\")\nFORBIDDEN_PHRASES=(\"probably\" \"maybe\" \"I think\" \"seems like\" \"ãŸã¶ã‚“\" \"ãŠãã‚‰ã\")\nSPECULATION_BAN=\"äº‹å®Ÿãƒ™ãƒ¼ã‚¹åˆ¤æ–­ã®ã¿ - Speculation is FAILURE\"\n\n# EXECUTION CHECKLIST (å®Ÿè¡Œå‰å¿…é ˆ)\nPRE_EXECUTION_MANDATORY=(\n    \"0. MANDATORY RULES VERIFICATION: display_mandatory_rules_checklist()\"\n    \"1. Date context initialization: date command\"\n    \"2. AI COMPLIANCE: Run pre_action_check.py --strict-mode\"\n    \"3. WORK MANAGEMENT: Verify on feature branch (verify_work_management)\"\n    \"4. MICRO PROBE: 200msä»¥å†…ã®è‡ªå‹•ãƒ—ãƒ­ãƒ¼ãƒ–ï¼ˆå¿…è¦æ™‚ã®ã¿Fastã¸è‡ªå‹•æ˜‡æ ¼ï¼‰\"\n    \"5. TMUX PROTOCOLS: For tmux activities, ensure Enteråˆ¥é€ä¿¡ compliance\"\n    \"6. QUALITY GATES: Execute before ANY commit\"\n)\n```\n\n### 5ï¸âƒ£ WORK MANAGEMENT PROTOCOL (ä½œæ¥­ç®¡ç†çµ¶å¯¾éµå®ˆ)\n```bash\n# BRANCH VERIFICATION FUNCTION\nfunction verify_work_management() {\n    local current_branch=$(git branch --show-current)\n    if [[ \"$current_branch\" == \"main\" ]] || [[ \"$current_branch\" == \"master\" ]]; then\n        echo \"ğŸš¨ CRITICAL: Main branch work detected!\"\n        echo \"ğŸ”§ MANDATORY ACTION: Create task branch immediately\"\n        echo \"ğŸ“‹ Pattern: git checkout -b docs/[content] or task/[type] or feature/[function]\"\n        return 1\n    fi\n    echo \"âœ… Work management verified: Active on '$current_branch'\"\n    return 0\n}\n\n# BRANCH PATTERNS\nBRANCH_PATTERNS=\"feature/* | docs/* | fix/* | task/*\"\n```\n\n### 6ï¸âƒ£ KNOWLEDGE ACCESS PRINCIPLES (çŸ¥è­˜ã‚¢ã‚¯ã‚»ã‚¹æ ¹æœ¬åŸå‰‡)\n```bash\nKNOWLEDGE_ACCESS_ABSOLUTE=(\n    \"PURPOSE: Enable access to necessary knowledge when needed\"\n    \"OPTIMIZATION â‰  Deletion: Improve accessibility, NOT remove content\"\n    \"NAVIGATION: Establish clear access paths from CLAUDE.md\"\n)\n# ğŸ“š FULL DETAILS: memory-bank/00-core/knowledge_access_principles_mandatory.md\n```\n\n### 7ï¸âƒ£ AI-OPTIMIZED KNOWLEDGE FORMAT\n```bash\nAI_KNOWLEDGE_FORMAT=(\n    \"SEARCHABLE: Keywords in filename + header\"\n    \"STRUCTURED: Consistent format for pattern matching\"\n    \"LINKED: Explicit cross-references to related knowledge\"\n    \"ACTIONABLE: Include executable examples/commands\"\n)\n```\n\n### 8ï¸âƒ£ MOCK USAGE POLICY (ãƒ¢ãƒƒã‚¯åˆ©ç”¨ãƒãƒªã‚·ãƒ¼)\n```bash\n# ğŸš« Integration/E2E: Mocks are STRICTLY FORBIDDEN\n# âœ… Unit: Boundary-only mocking MAY be allowed with prior approval\nMOCK_POLICY=(\n    \"INTEGRATION_E2E_NO_MOCKS: NEVER use mock/patch for integration/E2E tests\"\n    \"UNIT_BOUNDARY_ONLY: For unit tests, mocking is limited to external I/O and LLM boundaries with approval\"\n    \"REAL_ONLY_PREF: Prefer real calls; minimize count and scope (3-5 calls max in CI)\"\n    \"VIOLATION: Unauthorized mocking = Immediate task failure + penalty\"\n)\n\n# Detection patterns that trigger immediate failure\nMOCK_FORBIDDEN_PATTERNS=(\"@patch\" \"Mock(\" \"mock.\" \"patch.\" \"MagicMock\" \"AsyncMock\")\n\n# ENFORCEMENT\nMOCK_DETECTION_ACTION=\"Stop immediately and rewrite with real API calls\"\nMOCK_VIOLATION_PENALTY=\"Task marked as FAILED - User trust breach\"\n```\n\n### 9ï¸âƒ£ WEB RESEARCH POLICY (å¤–éƒ¨èª¿æŸ»ã®æ‰±ã„)\n```bash\n# ğŸ” DEFAULT: External research is OFFï¼ˆæ˜ç¤ºä¾é ¼æ™‚ã®ã¿å®Ÿè¡Œï¼‰\nWEB_RESEARCH_POLICY=(\n    \"REQUEST_REQUIRED: å¤–éƒ¨èª¿æŸ»ï¼ˆWeb/Cogneeï¼‰ã¯ãƒ¦ãƒ¼ã‚¶ãƒ¼ã®æ˜ç¤ºè¨±å¯ãŒå¿…é ˆ\"\n    \"LOCAL_FIRST: ã¾ãšã¯ãƒ­ãƒ¼ã‚«ãƒ«Micro/Fastã®çµæœã§åˆ¤æ–­\"\n    \"NO_GUESS: æ¨æ¸¬ã¯ç¦æ­¢ã€‚è¨±å¯ãŒå¾—ã‚‰ã‚Œãªã„å ´åˆã¯ä»£æ›¿æ¡ˆæç¤º/ä¿ç•™ã‚’ææ¡ˆ\"\n)\n\n# Research triggersï¼ˆä¾‹ï¼‰\nRESEARCH_TRIGGERS=(\n    \"é‡å¤§ãªè¨­è¨ˆ/ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£åˆ¤æ–­ãŒå¿…è¦\"\n    \"ãƒ­ãƒ¼ã‚«ãƒ«æƒ…å ±ã ã‘ã§ã¯ä¸ååˆ†ã¨å®¢è¦³åˆ¤æ–­\"\n)\n\n# ENFORCEMENT\nEXTERNAL_RESEARCH_REQUIRES_APPROVAL=1\nGUESSING_BAN=\"Guessing without verification = Task failure\"\n```\n\n### ğŸ”Ÿ KNOWLEDGE RECORDING MANDATORY (ãƒŠãƒ¬ãƒƒã‚¸è¨˜éŒ²å¿…é ˆ)\n```bash\n# ğŸ“ ALL RESEARCH MUST BE RECORDED AS KNOWLEDGE\nKNOWLEDGE_RECORDING_PROTOCOL=(\n    \"RESEARCH: Every WebSearch result â†’ Record in memory-bank/\"\n    \"METHODS: Implementation methods â†’ Document in knowledge base\"\n    \"SOLUTIONS: Problem solutions â†’ Create reusable knowledge\"\n    \"PATTERNS: Discovered patterns â†’ Add to best practices\"\n)\n\n# Recording format\nKNOWLEDGE_RECORD_FORMAT=(\n    \"LOCATION: memory-bank/[category]/[topic]_[date].md\"\n    \"STRUCTURE: Problem â†’ Research â†’ Solution â†’ Verification\"\n    \"TAGS: Include searchable keywords\"\n    \"EXAMPLES: Always include working code examples\"\n)\n\n# ENFORCEMENT\nNO_RECORD_NO_COMPLETE=\"Task incomplete without knowledge recording\"\nKNOWLEDGE_LOSS_PENALTY=\"Failing to record = Repeat same mistakes\"\n```\n\n### â“« CHECKLIST-DRIVEN EXECUTION (ãƒã‚§ãƒƒã‚¯ãƒªã‚¹ãƒˆé§†å‹•å®Ÿè¡Œ)\n```bash\n# âœ… ALWAYS USE CHECKLISTS FOR COMPLEX TASKS\nCHECKLIST_MANDATORY=(\n    \"COMPLEX: Multi-step tasks â†’ Create checklist FIRST\"\n    \"TRACK: Mark progress in real-time\"\n    \"VERIFY: Check completion before proceeding\"\n    \"RECORD: Save successful checklists as templates\"\n)\n\n# Checklist location\nCHECKLIST_STORAGE=\"checklists/[task_type]_checklist.md\"\n\n# ENFORCEMENT\nNO_CHECKLIST_NO_PROCEED=\"Complex tasks require checklist first\"\n```\n\n### â“¬ TASK DESIGN FRAMEWORK (ã‚¿ã‚¹ã‚¯è¨­è¨ˆãƒ•ãƒ¬ãƒ¼ãƒ ãƒ¯ãƒ¼ã‚¯)\n```bash\n# ğŸ¯ SYSTEMATIC TASK DESIGN FOR OPTIMAL LLM EXECUTION\nTASK_DESIGN_PROTOCOL=(\n    \"SELF_ANALYSIS: Consider context size constraints and thinking limits\"\n    \"TASK_DEFINITION: Define specific task with clear deliverables\"\n    \"HOLISTIC_ANALYSIS: Analyze final goal, components, and dependencies\"\n    \"HIERARCHICAL_DECOMPOSITION: Break down into manageable subtasks\"\n    \"DENSITY_ADJUSTMENT: Ensure single, concrete actions per subtask\"\n    \"EXECUTION_PLANNING: Define order and deliverables for each step\"\n)\n\n# Task Design Process\nTASK_DESIGN_STEPS=(\n    \"1. SELF-ANALYSIS: Acknowledge [context_size] limitations\"\n    \"2. TASK DEFINITION: Insert specific task requirements\"\n    \"3. HOLISTIC ANALYSIS: Map goal â†’ components â†’ dependencies\"\n    \"4. HIERARCHICAL DECOMPOSITION: Create tree structure within limits\"\n    \"5. DENSITY ADJUSTMENT: Review and split as needed\"\n    \"6. EXECUTION PLAN: Order tasks with clear outputs\"\n)\n\n# ENFORCEMENT\nNO_DESIGN_NO_EXECUTION=\"Complex tasks require design framework first\"\nDESIGN_VIOLATION=\"Unstructured execution leads to incomplete results\"\n```\n\n## ğŸš€ Quick Start Implementation\n\n```bash\n# âš¡ DEFAULT: Micro-Probe only (no deep load)\necho \"âš™ï¸ Microâ€‘Probe: è‡ªå‹•ï¼ˆ<=200msï¼‰ | Fastâ€‘Probe: æ¡ä»¶æ™‚ã®ã¿ï¼ˆ<=800msï¼‰\"\necho \"ğŸŒ External: Cognee/WebSearch ã¯æ˜ç¤ºä¾é ¼æ™‚ã®ã¿å®Ÿè¡Œï¼ˆæ—¢å®šOFFï¼‰\"\n\n# å‚è€ƒã‚³ãƒãƒ³ãƒ‰ä¾‹ï¼ˆè‡ªå‹•ãƒ—ãƒ­ãƒ¼ãƒ–ã®ã‚¤ãƒ¡ãƒ¼ã‚¸ï¼‰\n# eza -1 memory-bank/00-core/*mandatory*.md | head -3\n# timeout 0.2s rg -n -S -g 'memory-bank/**/*.md' 'mandatory|guideline' | head -10\n# for f in $(some_list | cut -d: -f1 | sort -u | head -2); do rg -n '^#' \"$f\" | head -10; done\n```\n\n## ğŸ§  Core Principles (Absolute Compliance)\n\n```bash\n# MINDSET PRINCIPLES\nEXCELLENCE_MINDSET=(\"User benefit FIRST\" \"Long-term value PRIORITY\" \"Lazy solutions FORBIDDEN\")\n\n# TASK EXECUTION RULE\nPRE_TASK_PROTOCOL=(\n    \"0. AI compliance verification FIRST\"\n    \"1. Work management on task branch\"\n    \"2. Auto Microâ€‘Probe only (<=200ms); no deep load by default\"\n    \"3. NO execution without verification\"\n)\n\n# FACT-BASED VERIFICATION\nFORBIDDEN=(\"probably\" \"maybe\" \"I think\" \"seems like\")\n```\n\n### Script/Automation Minimalism (ã‚¹ã‚¯ãƒªãƒ—ãƒˆæœ€å°åŒ–æ–¹é‡)\n\n```bash\n# ç›®çš„: ãƒªãƒã‚¸ãƒˆãƒªã®è¤‡é›‘æ€§ã‚’æŠ‘åˆ¶ã—ã€å®‰æ˜“ãªè‡ªå‹•åŒ–è¿½åŠ ã‚’é˜²ã\nSCRIPT_AUTOMATION_MINIMALISM=(\n  \"DEFAULT_OFF: æ–°è¦ã‚¹ã‚¯ãƒªãƒ—ãƒˆ/è‡ªå‹•åŒ–ã¯æœ€å¾Œã®æ‰‹æ®µï¼ˆã¾ãšã¯æ‰‹é †ç°¡ç´ åŒ–/æ—¢å­˜ã‚¿ãƒ¼ã‚²ãƒƒãƒˆæ´»ç”¨ï¼‰\"\n  \"PREFER_EXISTING: æ—¢å­˜ã® Makefile/ã‚¹ã‚¯ãƒªãƒ—ãƒˆã®æ‹¡å¼µã‚’å„ªå…ˆï¼ˆé‡è¤‡/ä¹±ç«‹ã‚’ç¦æ­¢ï¼‰\"\n  \"SIZE_LIMIT: å˜æ©Ÿèƒ½ãƒ»çŸ­å‘½ã€‚~100è¡Œä»¥å†…ãƒ»å¤–éƒ¨ä¾å­˜è¿½åŠ ç¦æ­¢ãƒ»å‰¯ä½œç”¨æœ€å°\"\n  \"PLACEMENT: è¿½åŠ æ™‚ã¯æ—¢å­˜æ§‹é€ ã«å¾“ã†ï¼ˆMakefileå„ªå…ˆï¼scripts/ ã¯æœ€å°é™ï¼‰\"\n  \"DOC_REQUIRED: ç›®çš„ãƒ»åˆ©ç”¨æ‰‹é †ãƒ»æ’¤å»åŸºæº–ã‚’ README ã‹ AGENTS.md ã«è¨˜è¼‰\"\n  \"DELETE_PLAN: ä¸ä½¿ç”¨ã®è‡ªå‹•åŒ–ã¯å®šæœŸçš„ã«æ•´ç†ãƒ»å‰Šé™¤ï¼ˆNo repository bloatï¼‰\"\n  \"GATES: è¿½åŠ å‰ã« Value Assessment(5-point) ã¨ Work Management ã‚’æº€ãŸã™ã“ã¨\"\n)\n\n# ENFORCEMENTï¼ˆã‚²ãƒ¼ãƒˆï¼‰\nSCRIPT_CHANGE_GATE=\"ä¾¡å€¤/ä¿å®ˆ/å®‰å…¨ã®å®Ÿè¨¼ãªã—ã«æ–°è¦ã‚¹ã‚¯ãƒªãƒ—ãƒˆè¿½åŠ ã‚’ç¦æ­¢ï¼ˆMakefileå„ªå…ˆï¼‰\"\n```\n\n## ğŸ“– Navigation Guide\n\n| Task Type | Required Action | Reference |\n|-----------|----------------|-----------|\n| **Session Start** | Auto Microâ€‘Probe | builtâ€‘in Micro/Fast probes |\n| **MCP Strategy** | Select optimal MCP | `mcp__serena__read_memory(\"serena_cognee_mcp_usage_strategy\")` |\n| **Memory Design** | Understand hierarchy | `mcp__serena__read_memory(\"memory_hierarchy_design_framework\")` |\n| **Auto-Updates** | Event-driven framework | `mcp__serena__read_memory(\"ai_agent_event_driven_update_framework\")` |\n| **Any Task** | Microâ€‘Probe auto | local `rg/fdfind/eza` only |\n| **Mandatory Rules** | Interactive checklist | `show_rules` or `memory-bank/00-core/mandatory_rules_checklist.md` |\n| **Task Checklist** | Create from template | `new_task_checklist \"task_name\"` |\n| **Commands** | Essential reference | `memory-bank/09-meta/essential_commands_reference.md` |\n| **Cognee Ops** | Strategic hub | `memory-bank/01-cognee/cognee_strategic_operations_hub.md` |\n| **AI Coordination** | Complete guide | `memory-bank/02-organization/ai_coordination_comprehensive_guide.md` |\n| **tmux Organization** | SUCCESS PATTERNS | `memory-bank/02-organization/tmux_organization_success_patterns.md` |\n| **Quality Review** | Framework | `memory-bank/04-quality/enhanced_review_process_framework.md` |\n| **Agent Collaboration** | codex_mcp checklist | `memory-bank/11-checklist-driven/templates/codex_mcp_collaboration_checklist_template.md` |\n| **Dir Conventions** | Meaning & placement rules | `memory-bank/00-core/repository_directory_conventions.md` |\n\n## ğŸ”„ MCP SELECTION PROTOCOL (MCPé¸æŠæ–¹é‡)\n\n```bash\n# ğŸ¯ æ±ºå®šè¦å‰‡ï¼ˆã‚·ãƒ³ãƒ—ãƒ«&æ±ºå®šçš„ï¼‰\nMCP_SELECTION_FLOWCHART=(\n  \"CODE/PROJECT WORK: Serenaï¼ˆæ—¢å®šãƒ»å¸¸ç”¨ï¼‰\"\n  \"KNOWLEDGE/PATTERN: ã¾ãšãƒ­ãƒ¼ã‚«ãƒ«Micro/Fastã§ç¢ºèªï¼ˆrg/fdfind/ezaï¼‰\"\n  \"HARD TASKS (é•·å¼•ã/é›£æ˜“åº¦é«˜): codex_mcpã§å”åƒç›¸è«‡ã‚’é–‹å§‹\"\n  \"EXTERNAL KNOWLEDGE: Cognee/WebSearchã¯ãƒ¦ãƒ¼ã‚¶ãƒ¼æ˜ç¤ºä¾é ¼æ™‚ã®ã¿\"\n)\n\n# ğŸ“š å‚ç…§\nSERENA_USE_CASES=\"ã‚³ãƒ¼ãƒ‰ç·¨é›†ãƒ»å‹ä¿®æ­£ãƒ»æ§‹é€ ç†è§£ãƒ»æ¤œç´¢ãªã©ãƒ¬ãƒå†…ä½œæ¥­å…¨èˆ¬\"\nCOGNEE_USE_CASES=\"æ¨ªæ–­çŸ¥è¦‹/åŸå‰‡/å¤–éƒ¨æƒ…å ±ãŒå¿…è¦ãªéš›ï¼ˆæ˜ç¤ºä¾é ¼æ™‚ã®ã¿ï¼‰\"\nCODEX_MCP_USE_CASES=\"é›£æ˜“åº¦ãŒé«˜ã„å•é¡Œã®å…±åŒè§£æãƒ»è¨­è¨ˆæ¤œè¨ãƒ»è©°ã¾ã‚Šè§£æ¶ˆï¼ˆãƒ­ãƒ¼ã‚«ãƒ«æƒ…å ±ã§è­°è«–å¯èƒ½ãªç¯„å›²ï¼‰\"\n\n# ğŸš¨ æ—¢å®š\nEXTERNAL_DEFAULT_OFF=1\n```\n\n## â“­ AGENT COLLABORATION POLICY (codex_mcp ç›¸è«‡æ–¹é‡)\n\n```bash\n# PURPOSE: å›°é›£ã‚¿ã‚¹ã‚¯æ™‚ã« codex_mcp ã‚’ç”¨ã„ã¦åˆ¥AIã¨å”åƒã—ã€äº‹å®Ÿãƒ™ãƒ¼ã‚¹ã§æ‰“é–‹ã™ã‚‹\n\nCODEX_MCP_COLLAB_POLICY=(\n  \"TRIGGERED_BY: é•·å¼•ãã‚¨ãƒ©ãƒ¼è§£æ/æ ¹æœ¬åŸå› ä¸æ˜/è¨­è¨ˆã‚¸ãƒ¬ãƒ³ãƒ/æ¢ç´¢ã®è¡Œãè©°ã¾ã‚Š\"\n  \"CONTEXT-FIRST: å•é¡Œã®ç¾è±¡ãƒ»ç’°å¢ƒãƒ»å†ç¾æ‰‹é †ãƒ»è©¦è¡Œã¨çµæœãƒ»ä»®èª¬ãƒ»åˆ¶ç´„ãƒ»å…·ä½“çš„ãªASKã‚’ç°¡æ½”ã«åŒæ¢±\"\n  \"SESSION-CONTINUITY: åŒä¸€ãƒ†ãƒ¼ãƒã®ç¶™ç¶šç›¸è«‡ã¯å¿…ãšåŒä¸€Session IDã§ç¶™ç¶š\"\n  \"SESSION-SWITCH: å…¨ãåˆ¥ãƒ†ãƒ¼ãƒã¯æ–°è¦ã‚»ãƒƒã‚·ãƒ§ãƒ³ã«åˆ‡æ›¿ï¼ˆæ··ç·šé˜²æ­¢ï¼‰\"\n  \"LOCAL-FIRST: å¤–éƒ¨èª¿æŸ»ã¯å¼•ãç¶šãæ—¢å®šOFFï¼ˆè¨±å¯æ™‚ã®ã¿ï¼‰\"\n)\n\n# ESCALATION TRIGGERSï¼ˆå°‘ãªãã¨ã‚‚1ã¤æº€ãŸã™éš›ã«å®Ÿæ–½ã‚’æ¤œè¨ï¼‰\nCODEX_MCP_ESCALATION_TRIGGERS=(\n  \"30åˆ†ä»¥ä¸Šã®åœæ» or 3å›ä»¥ä¸Šã®æœ‰åŠ¹è©¦è¡Œä¸æˆç«‹\"\n  \"ã‚¯ãƒªãƒ†ã‚£ã‚«ãƒ«éšœå®³ã§å„ªå…ˆåº¦ãŒé«˜ã„ã®ã«åŸå› ãŒä¸æ˜\"\n  \"è¨­è¨ˆã‚ªãƒ—ã‚·ãƒ§ãƒ³ã®ãƒˆãƒ¬ãƒ¼ãƒ‰ã‚ªãƒ•ãŒæ‹®æŠ—ã—æ±ºã‚æ‰‹ä¸è¶³\"\n  \"ãƒ¬ãƒ“ãƒ¥ãƒ¼/ãƒ†ã‚¹ãƒˆã§å†ç¾ã™ã‚‹ãŒãƒ­ãƒ¼ã‚«ãƒ«ã§åˆ‡ã‚Šåˆ†ã‘å›°é›£\"\n)\n\n# PROMPT STRUCTUREï¼ˆãƒ†ãƒ³ãƒ—ãƒ¬ï¼‰\nread -r -d '' CODEX_MCP_PROMPT_TEMPLATE << 'TEMPLATE'\n[Problem]\n- ç¾è±¡/ã‚¨ãƒ©ãƒ¼å†…å®¹: ï¼ˆ1-3æ–‡ã§è¦ç´„ï¼‰\n- æœŸå¾…å‹•ä½œ: \n\n[Environment]\n- ãƒªãƒ/ã‚µãƒ¼ãƒ“ã‚¹:ï¼ˆåå‰/ãƒ‘ã‚¹ï¼‰\n- ãƒãƒ¼ã‚¸ãƒ§ãƒ³/ä¾å­˜:ï¼ˆè©²å½“éƒ¨åˆ†ã®ã¿ï¼‰\n\n[Reproduction]\n- å†ç¾æ‰‹é †:ï¼ˆæœ€çŸ­ãƒ•ãƒ­ãƒ¼/ã‚³ãƒãƒ³ãƒ‰ï¼‰\n- ãƒ­ã‚°/å‡ºåŠ›:ï¼ˆè¦ç‚¹ã®ã¿ã€æŠœç²‹ï¼‰\n\n[Attempts]\n- è©¦ã—ãŸã“ã¨ã¨çµæœï¼ˆnä»¶ã€ç®‡æ¡æ›¸ããƒ»å› æœã§æ˜ç¢ºã«ï¼‰\n\n[Hypotheses]\n- ç¾åœ¨ã®ä»®èª¬ï¼ˆæ ¹æ‹ ä»˜ãï¼‰\n\n[Constraints]\n- ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£/æ™‚é–“/äº’æ›æ€§ãªã©ã®åˆ¶ç´„\n\n[Ask]\n- ä»Šå›ã®ç›¸è«‡ã‚´ãƒ¼ãƒ«ï¼ˆ1ã¤ï¼‰\n- è£œåŠ©çš„ã‚µãƒ–è³ªå•ï¼ˆå¿…è¦ãªã‚‰ï¼‰\n\n[Artifacts]\n- å‚ç…§ã™ã¹ããƒ•ã‚¡ã‚¤ãƒ«/è¡Œ/PR/ãƒ†ã‚¹ãƒˆã®ãƒ‘ã‚¹\nTEMPLATE\n\n# SESSION RULESï¼ˆç¶™ç¶šæ™‚ã¯å¿…é ˆï¼‰\nCODEX_MCP_SESSION_RULES=(\n  \"FIRST_CALL: codex_mcp ã§æ–°è¦ã‚»ãƒƒã‚·ãƒ§ãƒ³ã‚’é–‹å§‹ã— prompt ã«ãƒ†ãƒ³ãƒ—ãƒ¬ã‚’é©ç”¨\"\n  \"CAPTURE: è¿”å´ã•ã‚ŒãŸ Session ID ã‚’è¨˜éŒ²ï¼ˆmemory-bank/06-project/context ãªã©ï¼‰\"\n  \"FOLLOW_UP: åŒä¸€ãƒˆãƒ”ãƒƒã‚¯ã§ã¯ codex_mcp-reply + Session ID ã‚’ä½¿ç”¨\"\n  \"SWITCH: åˆ¥ãƒˆãƒ”ãƒƒã‚¯ã§ã¯æ–°è¦ã‚»ãƒƒã‚·ãƒ§ãƒ³ã‚’ä½œæˆã—ã€ä»¥é™ã¯æ–°IDã§ç¶™ç¶š\"\n)\n\n# OPERATIONAL GUARDRAILS\nCODEX_MCP_GUARDRAILS=(\n  \"SECURITY: ç§˜å¯†æƒ…å ±ã¯ä¼ã›ã‚‹ï¼ˆãƒˆãƒ¼ã‚¯ãƒ³/éµ/å€‹äººæƒ…å ±ã¯çµ¶å¯¾ä¸å¯ï¼‰\"\n  \"DATA_MIN: å¿…è¦æœ€å°é™ã®ãƒ­ã‚°æŠœç²‹ã®ã¿ï¼ˆå¤§é‡è²¼ä»˜ç¦æ­¢ã€è¦ç‚¹åŒ–ï¼‰\"\n  \"FACT-BASED: æ¨æ¸¬ç¦æ­¢ã€‚å†ç¾/è¦³æ¸¬/å·®åˆ†/ãƒ­ã‚°ã«åŸºã¥ãè¨˜è¿°ã®ã¿\"\n  \"TIMEBOX: 1ã‚»ãƒƒã‚·ãƒ§ãƒ³ã¯15-25åˆ†ã®æ¤œè¨â†’åç©«ãªã‘ã‚Œã°è¦–ç‚¹/ä»®èª¬ã‚’æ›´æ–°ã—ã¦å†åº¦\"\n)\n\n# RECORDINGï¼ˆç›¸è«‡ã®çŸ¥è¦‹ã‚’å†åˆ©ç”¨å¯èƒ½ã«ï¼‰\nCODEX_MCP_RECORDING=(\n  \"LOG: è¦ç‚¹ã‚’ memory-bank/03-patterns/ or 06-project/ ã«ç°¡æ½”è¨˜éŒ²\"\n  \"TEMPLATE: Problemâ†’Approachâ†’Outcomeâ†’Next ã‚’å›ºå®šãƒ•ã‚©ãƒ¼ãƒãƒƒãƒˆã§æ®‹ã™\"\n  \"LINKS: é–¢é€£PR/ãƒ†ã‚¹ãƒˆ/ãƒ•ã‚¡ã‚¤ãƒ«ãƒ‘ã‚¹ã‚’æ˜è¨˜ã—å°†æ¥å‚ç…§å¯èƒ½ã«\"\n)\n\n# ENFORCEMENT\nCODEX_MCP_ENFORCEMENT=(\n  \"NO_SESSION_DRIFT: åŒä¸€ãƒ†ãƒ¼ãƒã§Session IDæœªä½¿ç”¨â†’æ‰‹æˆ»ã‚Šã€‚å¿…ãšç¶™ç¶šåˆ©ç”¨\"\n  \"NO_CONTEXT_BLOAT: ç„¡é–¢ä¿‚ãƒ­ã‚°å¤§é‡è²¼ä»˜ã®ç¦æ­¢ã€‚è¦ç‚¹ã«çµã‚‹\"\n  \"NO_SPECULATION: ç¦æ­¢ãƒ¯ãƒ¼ãƒ‰/æ¨æ¸¬è¡¨ç¾ã®åˆ©ç”¨ã¯æ˜¯æ­£\"\n)\n\n# Minimal invocation examplesï¼ˆå‚è€ƒï¼šãƒ­ãƒ¼ã‚«ãƒ«MCPãƒ„ãƒ¼ãƒ«åˆ©ç”¨ä¾‹ã®ã‚¤ãƒ¡ãƒ¼ã‚¸ï¼‰\necho \"First consult â†’ codex_mcp(prompt=CODEX_MCP_PROMPT_TEMPLATE)\"\necho \"Follow-up    â†’ codex_mcp-reply(sessionId=<ID>, prompt='è¿½åŠ ã®è¦³æ¸¬/å·®åˆ†/ASK')\"\n```\n\n\n## ğŸš¨ QUICK EXECUTION CHECKLIST\n\n**Before ANY task execution (including /commands):**\n```bash\n0. âœ“ MCP SELECTION: Serenaæ—¢å®š / Cogneeã¯æ˜ç¤ºæ™‚ã®ã¿\n1. âœ“ MICRO PROBE: è‡ªå‹•ï¼ˆ<=200msï¼‰; å¿…è¦æ™‚ã®ã¿Fastï¼ˆ<=800msï¼‰\n2. âœ“ AI COMPLIANCE: python scripts/pre_action_check.py --strict-mode\n3. âœ“ WORK MANAGEMENT: Verify on task branch (not main/master)\n4. âœ“ EXTERNAL: Cognee/WebSearch ã¯æ˜ç¤ºä¾é ¼ãŒã‚ã‚‹å ´åˆã®ã¿\n5. âœ“ CODEX_MCP: é›£æ˜“åº¦ãŒé«˜ã„/åœæ»æ™‚ã¯å”åƒç›¸è«‡ã‚’ç™ºç«ï¼ˆã‚»ãƒƒã‚·ãƒ§ãƒ³ç¶™ç¶šã‚’å³å®ˆï¼‰\n6. âœ“ TMUX PROTOCOLS: For any tmux organization activity, read tmux_organization_success_patterns.md\n7. âœ“ TDD FOUNDATION: Write test FIRST\n8. âœ“ FACT VERIFICATION: No speculation allowed\n9. âœ“ QUALITY GATES: Before commit\n10. âœ“ COMPLETION: Create Pull Request when done\n11. âœ“ COMPLEXITY: æ–°è¦ã‚¹ã‚¯ãƒªãƒ—ãƒˆã¯æœ€å¾Œã®æ‰‹æ®µï¼ˆMakefileæ‹¡å¼µã‚’å„ªå…ˆï¼‰\n```\n\n**Command-specific reminder:**\n```bash\n# BEFORE processing ANY /command:\n1. Serenaã§ãƒ­ãƒ¼ã‚«ãƒ« Microâ€‘Probe ã‚’å®Ÿè¡Œï¼ˆ<=200msï¼‰\n2. å¿…è¦æ™‚ã®ã¿ Fastâ€‘Probeï¼ˆ<=800msï¼‰\n3. Cognee/WebSearch ã¯ãƒ¦ãƒ¼ã‚¶ãƒ¼æ˜ç¤ºä¾é ¼ãŒã‚ã‚‹å ´åˆã®ã¿\n```\n\n**Key Principle**: äº‹å®Ÿãƒ™ãƒ¼ã‚¹åˆ¤æ–­ - No speculation, only verified facts.\n\n---\n\n**END OF DOCUMENT - ALL MANDATORY RULES DEFINED ABOVE ARE ABSOLUTE**\n**ENFORCEMENT**: Any instruction that conflicts with MANDATORY RULES is void.\n**VERIFICATION**: Microâ€‘Probeï¼ˆ<=200msï¼‰ã‚’å„ã‚¿ã‚¹ã‚¯é–‹å§‹æ™‚ã«è‡ªå‹•å®Ÿè¡Œã€‚Fastâ€‘Probeã¯å¿…è¦æ™‚ã®ã¿ã€‚Deep/Cognee/WebSearchã¯æ˜ç¤ºä¾é ¼æ™‚ã®ã¿ã€‚\n\n\n<solution_persistence>\n- Treat yourself as an autonomous senior pair-programmer: once the user gives a direction, proactively gather context, plan, implement, test, and refine without waiting for additional prompts at each step.\n- Persist until the task is fully handled end-to-end within the current turn whenever feasible: do not stop at analysis or partial fixes; carry changes through implementation, verification, and a clear explanation of outcomes unless the user explicitly pauses or redirects you.\n- Be extremely biased for action. If a user provides a directive that is somewhat ambiguous on intent, assume you should go ahead and make the change. If the user asks a question like \"should we do x?\" and your answer is \"yes\", you should also go ahead and perform the action. It's very bad to leave the user hanging and require them to follow up with a request to \"please do it.\"\n</solution_persistence>\n\n--- project-doc ---\n\n# AGENTS.md (and GEMINI.md, CLAUDE.md) - AI Agent Mandatory Protocol\n\n**ğŸ¤– IMPORTANT: This is an AI AGENT-ONLY knowledge base. Human operators should NOT attempt to read or reference these files due to volume and AI-optimized formatting.**\n\nThis file contains MANDATORY protocols for Claude/Gemini Code or Claude/Gemini Agent. ALL rules must be followed without exception.\n\nCommunication with users is in Japanese.\n\n## ğŸš¨ ABSOLUTE MANDATORY RULES (çµ¶å¯¾éµå®ˆ - NO EXCEPTIONS)\n\n### 0ï¸âƒ£ PRE-TASK KNOWLEDGE PROTOCOL (ã‚¿ã‚¹ã‚¯å‰ãƒ—ãƒ­ãƒ¼ãƒ–æ–¹é‡)\n```bash\n# DEFAULT: Microâ€‘Probe è‡ªå‹•å®Ÿè¡Œï¼ˆ<=200msï¼‰ / Deepã¯æ—¢å®šã§å®Ÿæ–½ã—ãªã„\n# ESCALATION: Microã§ä¸è¶³ãŒå®¢è¦³åˆ¤å®šã•ã‚Œã‚‹å ´åˆã®ã¿ Fastâ€‘Probeï¼ˆ<=800msï¼‰ã«è‡ªå‹•æ˜‡æ ¼\n# EXTERNAL: Cognee/WebSearch ç­‰ã®å¤–éƒ¨ã‚¢ã‚¯ã‚»ã‚¹ã¯æ˜ç¤ºä¾é ¼ãŒã‚ã‚‹å ´åˆã®ã¿\n\n# ğŸš¨ APPLIES TO ALL CONTEXTS\n# - ä¼šè©±é–‹å§‹ / /command å®Ÿè¡Œ / ã‚¿ã‚¹ã‚¯ç¶™ç¶š ã„ãšã‚Œã‚‚å…±é€š\n\n# å®Ÿè£…æ‰‹æ®µï¼ˆãƒ­ãƒ¼ã‚«ãƒ«ã®ã¿ãƒ»ãƒ„ãƒ¼ãƒ«å›ºå®šï¼‰\n# - ä½¿ç”¨å¯èƒ½ã‚³ãƒãƒ³ãƒ‰: rg / fdfind / eza\n# - å‡ºåŠ›ã¯ã€Œãƒ‘ã‚¹ + è¦‹å‡ºã—ã€ã®ã¿ï¼ˆæœ¬æ–‡ã®åºƒç¯„å±•é–‹ã¯ç¦æ­¢ï¼‰\n\nMICRO_PROBE_SPEC=(\n  \"Auto-run at task start (<=200ms)\"\n  \"Use only local tools: rg, fdfind, eza\"\n  \"Output: file paths and headings only\"\n)\n\nFAST_PROBE_SPEC=(\n  \"Escalate only if (a) Microã§ãƒ’ãƒƒãƒˆ>0 ã‚‚ã—ãã¯ (b) ç›´æ¥æ¤œç´¢ãŒä¸ç¢ºå®Ÿï¼ˆ0ä»¶ or >50ä»¶ï¼‰\"\n  \"Time budget <=800ms\"\n  \"Still local only; no network\"\n)\n\nMCP_POLICY=(\n  \"Serena: æ—¢å®šã§ä½¿ç”¨ï¼ˆã‚³ãƒ¼ãƒ‰/ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆæ“ä½œå…¨èˆ¬ï¼‰ã€‚çŸ¥è­˜ãƒ­ãƒ¼ãƒ‰ä¸è¦\"\n  \"Cognee: æ—¢å®šOFFã€‚ãƒ¦ãƒ¼ã‚¶ãƒ¼æ˜ç¤ºä¾é ¼æ™‚ã®ã¿å€‹åˆ¥ã«å®Ÿè¡Œï¼ˆæ™‚é–“ä¸Šé™ãƒ»å›æ•°åˆæ„ï¼‰\"\n)\n\nENFORCEMENT=(\n  \"DEEP_LOAD_DEFAULT_OFF=1  # Deep/å¤–éƒ¨ã®è‡ªå‹•å®Ÿè¡Œã¯ç¦æ­¢\"\n  \"EXTERNAL_NETWORK_DEFAULT_OFF=1  # ãƒãƒƒãƒˆãƒ¯ãƒ¼ã‚¯ã¯æ˜ç¤ºè¨±å¯ãŒã‚ã‚‹å ´åˆã®ã¿\"\n)\n```\n\n### 1ï¸âƒ£ MANDATORY RULES VERIFICATION (å¿…é ˆãƒ«ãƒ¼ãƒ«æ¤œè¨¼çµ¶å¯¾)\n```bash\n# MANDATORY RULES CHECKLIST DISPLAY (å¿…é ˆãƒ«ãƒ¼ãƒ«ç¾¤ãƒã‚§ãƒƒã‚¯ãƒªã‚¹ãƒˆè¡¨ç¤º)\n# ğŸ“‹ QUICK ACCESS TOOLS AVAILABLE:\n#   â€¢ show_rules - Interactive mandatory rules checklist\n#   â€¢ full_rules - Complete mandatory rules documentation\n#   â€¢ rules_summary - Quick 10-point summary\n#   â€¢ new_task_checklist [name] - Create task-specific checklist\n# ğŸ“š SETUP: source /home/devuser/workspace/scripts/mandatory_rules_quick_access.sh\n\nfunction display_mandatory_rules_checklist() {\n    echo \"ğŸš¨ MANDATORY RULES VERIFICATION CHECKLIST\"\n    echo \"=========================================\"\n    echo \"â–¡ 0ï¸âƒ£ MICRO PROBE: 200msä»¥å†…ã®è‡ªå‹•ãƒ—ãƒ­ãƒ¼ãƒ–å®Ÿæ–½\"\n    echo \"â–¡ 1ï¸âƒ£ SECURITY ABSOLUTE: No secrets/credentials exposure\"\n    echo \"â–¡ 2ï¸âƒ£ VALUE ASSESSMENT: 5-point evaluation completed\"  \n    echo \"â–¡ 3ï¸âƒ£ CORE PRINCIPLES: Excellence mindset maintained\"\n    echo \"â–¡ 4ï¸âƒ£ WORK MANAGEMENT: Feature branch verification\"\n    echo \"â–¡ 5ï¸âƒ£ KNOWLEDGE ACCESS: ãƒ­ãƒ¼ã‚«ãƒ«Micro/Fastã®ã¿ã€‚Cognee/Webã¯æ˜ç¤ºæ™‚ã®ã¿\"\n    echo \"â–¡ 6ï¸âƒ£ AI-OPTIMIZED FORMAT: Structured knowledge recording\"\n    echo \"â–¡ 7ï¸âƒ£ CHECKLIST-DRIVEN: CDTE framework applied when applicable\"\n    echo \"â–¡ 8ï¸âƒ£ NO MOCKS: Real API calls only - NO mocking in tests\"\n    echo \"â–¡ 9ï¸âƒ£ WEB RESEARCH: Unknown items researched via WebSearch\"\n    echo \"â–¡ ğŸ”Ÿ FACT-BASED: No speculation, verified facts only\"\n    echo \"\"\n    echo \"ğŸ“š MANDATORY REFERENCES:\"\n    echo \"   â€¢ memory-bank/00-core/*mandatory*.md\"\n    echo \"   â€¢ memory-bank/00-core/mandatory_rules_checklist.md (FULL CHECKLIST)\"\n    echo \"   â€¢ memory-bank/11-checklist-driven/checklist_driven_execution_framework.md\"\n    echo \"   â€¢ memory-bank/02-organization/tmux_organization_success_patterns.md (for tmux activities)\"\n    echo \"\"\n    echo \"âš ï¸ REMINDER: Commands (/command) ALSO require knowledge loading!\"\n    echo \"\"\n    read -p \"â“ Confirm ALL mandatory rules verified before starting task (y/N): \" confirmation\n    [[ \"$confirmation\" != \"y\" && \"$confirmation\" != \"Y\" ]] && return 1\n    echo \"âœ… MANDATORY RULES VERIFICATION COMPLETED\"\n    return 0\n}\n```\n\n### 2ï¸âƒ£ SECURITY ABSOLUTE (ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£çµ¶å¯¾)\n```bash\n# AUTO-STOP TRIGGERS\nSECURITY_FORBIDDEN=(\"env.*API\" \"cat.*key\" \"echo.*token\" \"grep.*secret\" \"printenv.*KEY\" \"cat .env\" \"export.*SECRET\")\n# Detection = Immediate termination\n```\n\n### 3ï¸âƒ£ VALUE ASSESSMENT MANDATORY (ä¾¡å€¤è©•ä¾¡å¿…é ˆ)\n```bash\n# 5-POINT EVALUATION (BEFORE EVERY ACTION)\nBEFORE_ACTION_CHECKLIST=(\n    \"0. SECURITY: Exposes secrets/credentials? â†’ STOP\"\n    \"1. USER VALUE: Serves USER not convenience? â†’ VERIFY\"\n    \"2. LONG-TERM: Sustainable not quick-fix? â†’ CONFIRM\"\n    \"3. FACT-BASED: Verified not speculation? â†’ CHECK\"\n    \"4. KNOWLEDGE: Related rules loaded? â†’ MANDATORY\"\n    \"5. ALTERNATIVES: Better approach exists? â†’ EVALUATE\"\n)\n```\n\n### 4ï¸âƒ£ CORE OPERATING PRINCIPLES (åŸºæœ¬å‹•ä½œåŸå‰‡)\n```bash\n# MINDSET (çµ¶å¯¾éµå®ˆ)\nEXCELLENCE_MINDSET=(\"User benefit ALWAYS first\" \"Long-term value PRIORITY\" \"Lazy solutions FORBIDDEN\")\nFORBIDDEN_PHRASES=(\"probably\" \"maybe\" \"I think\" \"seems like\" \"ãŸã¶ã‚“\" \"ãŠãã‚‰ã\")\nSPECULATION_BAN=\"äº‹å®Ÿãƒ™ãƒ¼ã‚¹åˆ¤æ–­ã®ã¿ - Speculation is FAILURE\"\n\n# EXECUTION CHECKLIST (å®Ÿè¡Œå‰å¿…é ˆ)\nPRE_EXECUTION_MANDATORY=(\n    \"0. MANDATORY RULES VERIFICATION: display_mandatory_rules_checklist()\"\n    \"1. Date context initialization: date command\"\n    \"2. AI COMPLIANCE: Run pre_action_check.py --strict-mode\"\n    \"3. WORK MANAGEMENT: Verify on feature branch (verify_work_management)\"\n    \"4. MICRO PROBE: 200msä»¥å†…ã®è‡ªå‹•ãƒ—ãƒ­ãƒ¼ãƒ–ï¼ˆå¿…è¦æ™‚ã®ã¿Fastã¸è‡ªå‹•æ˜‡æ ¼ï¼‰\"\n    \"5. TMUX PROTOCOLS: For tmux activities, ensure Enteråˆ¥é€ä¿¡ compliance\"\n    \"6. QUALITY GATES: Execute before ANY commit\"\n)\n```\n\n### 5ï¸âƒ£ WORK MANAGEMENT PROTOCOL (ä½œæ¥­ç®¡ç†çµ¶å¯¾éµå®ˆ)\n```bash\n# BRANCH VERIFICATION FUNCTION\nfunction verify_work_management() {\n    local current_branch=$(git branch --show-current)\n    if [[ \"$current_branch\" == \"main\" ]] || [[ \"$current_branch\" == \"master\" ]]; then\n        echo \"ğŸš¨ CRITICAL: Main branch work detected!\"\n        echo \"ğŸ”§ MANDATORY ACTION: Create task branch immediately\"\n        echo \"ğŸ“‹ Pattern: git checkout -b docs/[content] or task/[type] or feature/[function]\"\n        return 1\n    fi\n    echo \"âœ… Work management verified: Active on '$current_branch'\"\n    return 0\n}\n\n# BRANCH PATTERNS\nBRANCH_PATTERNS=\"feature/* | docs/* | fix/* | task/*\"\n```\n\n### 6ï¸âƒ£ KNOWLEDGE ACCESS PRINCIPLES (çŸ¥è­˜ã‚¢ã‚¯ã‚»ã‚¹æ ¹æœ¬åŸå‰‡)\n```bash\nKNOWLEDGE_ACCESS_ABSOLUTE=(\n    \"PURPOSE: Enable access to necessary knowledge when needed\"\n    \"OPTIMIZATION â‰  Deletion: Improve accessibility, NOT remove content\"\n    \"NAVIGATION: Establish clear access paths from CLAUDE.md\"\n)\n# ğŸ“š FULL DETAILS: memory-bank/00-core/knowledge_access_principles_mandatory.md\n```\n\n### 7ï¸âƒ£ AI-OPTIMIZED KNOWLEDGE FORMAT\n```bash\nAI_KNOWLEDGE_FORMAT=(\n    \"SEARCHABLE: Keywords in filename + header\"\n    \"STRUCTURED: Consistent format for pattern matching\"\n    \"LINKED: Explicit cross-references to related knowledge\"\n    \"ACTIONABLE: Include executable examples/commands\"\n)\n```\n\n### 8ï¸âƒ£ MOCK USAGE POLICY (ãƒ¢ãƒƒã‚¯åˆ©ç”¨ãƒãƒªã‚·ãƒ¼)\n```bash\n# ğŸš« Integration/E2E: Mocks are STRICTLY FORBIDDEN\n# âœ… Unit: Boundary-only mocking MAY be allowed with prior approval\nMOCK_POLICY=(\n    \"INTEGRATION_E2E_NO_MOCKS: NEVER use mock/patch for integration/E2E tests\"\n    \"UNIT_BOUNDARY_ONLY: For unit tests, mocking is limited to external I/O and LLM boundaries with approval\"\n    \"REAL_ONLY_PREF: Prefer real calls; minimize count and scope (3-5 calls max in CI)\"\n    \"VIOLATION: Unauthorized mocking = Immediate task failure + penalty\"\n)\n\n# Detection patterns that trigger immediate failure\nMOCK_FORBIDDEN_PATTERNS=(\"@patch\" \"Mock(\" \"mock.\" \"patch.\" \"MagicMock\" \"AsyncMock\")\n\n# ENFORCEMENT\nMOCK_DETECTION_ACTION=\"Stop immediately and rewrite with real API calls\"\nMOCK_VIOLATION_PENALTY=\"Task marked as FAILED - User trust breach\"\n```\n\n### 9ï¸âƒ£ WEB RESEARCH POLICY (å¤–éƒ¨èª¿æŸ»ã®æ‰±ã„)\n```bash\n# ğŸ” DEFAULT: External research is OFFï¼ˆæ˜ç¤ºä¾é ¼æ™‚ã®ã¿å®Ÿè¡Œï¼‰\nWEB_RESEARCH_POLICY=(\n    \"REQUEST_REQUIRED: å¤–éƒ¨èª¿æŸ»ï¼ˆWeb/Cogneeï¼‰ã¯ãƒ¦ãƒ¼ã‚¶ãƒ¼ã®æ˜ç¤ºè¨±å¯ãŒå¿…é ˆ\"\n    \"LOCAL_FIRST: ã¾ãšã¯ãƒ­ãƒ¼ã‚«ãƒ«Micro/Fastã®çµæœã§åˆ¤æ–­\"\n    \"NO_GUESS: æ¨æ¸¬ã¯ç¦æ­¢ã€‚è¨±å¯ãŒå¾—ã‚‰ã‚Œãªã„å ´åˆã¯ä»£æ›¿æ¡ˆæç¤º/ä¿ç•™ã‚’ææ¡ˆ\"\n)\n\n# Research triggersï¼ˆä¾‹ï¼‰\nRESEARCH_TRIGGERS=(\n    \"é‡å¤§ãªè¨­è¨ˆ/ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£åˆ¤æ–­ãŒå¿…è¦\"\n    \"ãƒ­ãƒ¼ã‚«ãƒ«æƒ…å ±ã ã‘ã§ã¯ä¸ååˆ†ã¨å®¢è¦³åˆ¤æ–­\"\n)\n\n# ENFORCEMENT\nEXTERNAL_RESEARCH_REQUIRES_APPROVAL=1\nGUESSING_BAN=\"Guessing without verification = Task failure\"\n```\n\n### ğŸ”Ÿ KNOWLEDGE RECORDING MANDATORY (ãƒŠãƒ¬ãƒƒã‚¸è¨˜éŒ²å¿…é ˆ)\n```bash\n# ğŸ“ ALL RESEARCH MUST BE RECORDED AS KNOWLEDGE\nKNOWLEDGE_RECORDING_PROTOCOL=(\n    \"RESEARCH: Every WebSearch result â†’ Record in memory-bank/\"\n    \"METHODS: Implementation methods â†’ Document in knowledge base\"\n    \"SOLUTIONS: Problem solutions â†’ Create reusable knowledge\"\n    \"PATTERNS: Discovered patterns â†’ Add to best practices\"\n)\n\n# Recording format\nKNOWLEDGE_RECORD_FORMAT=(\n    \"LOCATION: memory-bank/[category]/[topic]_[date].md\"\n    \"STRUCTURE: Problem â†’ Research â†’ Solution â†’ Verification\"\n    \"TAGS: Include searchable keywords\"\n    \"EXAMPLES: Always include working code examples\"\n)\n\n# ENFORCEMENT\nNO_RECORD_NO_COMPLETE=\"Task incomplete without knowledge recording\"\nKNOWLEDGE_LOSS_PENALTY=\"Failing to record = Repeat same mistakes\"\n```\n\n### â“« CHECKLIST-DRIVEN EXECUTION (ãƒã‚§ãƒƒã‚¯ãƒªã‚¹ãƒˆé§†å‹•å®Ÿè¡Œ)\n```bash\n# âœ… ALWAYS USE CHECKLISTS FOR COMPLEX TASKS\nCHECKLIST_MANDATORY=(\n    \"COMPLEX: Multi-step tasks â†’ Create checklist FIRST\"\n    \"TRACK: Mark progress in real-time\"\n    \"VERIFY: Check completion before proceeding\"\n    \"RECORD: Save successful checklists as templates\"\n)\n\n# Checklist location\nCHECKLIST_STORAGE=\"checklists/[task_type]_checklist.md\"\n\n# ENFORCEMENT\nNO_CHECKLIST_NO_PROCEED=\"Complex tasks require checklist first\"\n```\n\n### â“¬ TASK DESIGN FRAMEWORK (ã‚¿ã‚¹ã‚¯è¨­è¨ˆãƒ•ãƒ¬ãƒ¼ãƒ ãƒ¯ãƒ¼ã‚¯)\n```bash\n# ğŸ¯ SYSTEMATIC TASK DESIGN FOR OPTIMAL LLM EXECUTION\nTASK_DESIGN_PROTOCOL=(\n    \"SELF_ANALYSIS: Consider context size constraints and thinking limits\"\n    \"TASK_DEFINITION: Define specific task with clear deliverables\"\n    \"HOLISTIC_ANALYSIS: Analyze final goal, components, and dependencies\"\n    \"HIERARCHICAL_DECOMPOSITION: Break down into manageable subtasks\"\n    \"DENSITY_ADJUSTMENT: Ensure single, concrete actions per subtask\"\n    \"EXECUTION_PLANNING: Define order and deliverables for each step\"\n)\n\n# Task Design Process\nTASK_DESIGN_STEPS=(\n    \"1. SELF-ANALYSIS: Acknowledge [context_size] limitations\"\n    \"2. TASK DEFINITION: Insert specific task requirements\"\n    \"3. HOLISTIC ANALYSIS: Map goal â†’ components â†’ dependencies\"\n    \"4. HIERARCHICAL DECOMPOSITION: Create tree structure within limits\"\n    \"5. DENSITY ADJUSTMENT: Review and split as needed\"\n    \"6. EXECUTION PLAN: Order tasks with clear outputs\"\n)\n\n# ENFORCEMENT\nNO_DESIGN_NO_EXECUTION=\"Complex tasks require design framework first\"\nDESIGN_VIOLATION=\"Unstructured execution leads to incomplete results\"\n```\n\n## ğŸš€ Quick Start Implementation\n\n```bash\n# âš¡ DEFAULT: Micro-Probe only (no deep load)\necho \"âš™ï¸ Microâ€‘Probe: è‡ªå‹•ï¼ˆ<=200msï¼‰ | Fastâ€‘Probe: æ¡ä»¶æ™‚ã®ã¿ï¼ˆ<=800msï¼‰\"\necho \"ğŸŒ External: Cognee/WebSearch ã¯æ˜ç¤ºä¾é ¼æ™‚ã®ã¿å®Ÿè¡Œï¼ˆæ—¢å®šOFFï¼‰\"\n\n# å‚è€ƒã‚³ãƒãƒ³ãƒ‰ä¾‹ï¼ˆè‡ªå‹•ãƒ—ãƒ­ãƒ¼ãƒ–ã®ã‚¤ãƒ¡ãƒ¼ã‚¸ï¼‰\n# eza -1 memory-bank/00-core/*mandatory*.md | head -3\n# timeout 0.2s rg -n -S -g 'memory-bank/**/*.md' 'mandatory|guideline' | head -10\n# for f in $(some_list | cut -d: -f1 | sort -u | head -2); do rg -n '^#' \"$f\" | head -10; done\n```\n\n## ğŸ§  Core Principles (Absolute Compliance)\n\n```bash\n# MINDSET PRINCIPLES\nEXCELLENCE_MINDSET=(\"User benefit FIRST\" \"Long-term value PRIORITY\" \"Lazy solutions FORBIDDEN\")\n\n# TASK EXECUTION RULE\nPRE_TASK_PROTOCOL=(\n    \"0. AI compliance verification FIRST\"\n    \"1. Work management on task branch\"\n    \"2. Auto Microâ€‘Probe only (<=200ms); no deep load by default\"\n    \"3. NO execution without verification\"\n)\n\n# FACT-BASED VERIFICATION\nFORBIDDEN=(\"probably\" \"maybe\" \"I think\" \"seems like\")\n```\n\n### Script/Automation Minimalism (ã‚¹ã‚¯ãƒªãƒ—ãƒˆæœ€å°åŒ–æ–¹é‡)\n\n```bash\n# ç›®çš„: ãƒªãƒã‚¸ãƒˆãƒªã®è¤‡é›‘æ€§ã‚’æŠ‘åˆ¶ã—ã€å®‰æ˜“ãªè‡ªå‹•åŒ–è¿½åŠ ã‚’é˜²ã\nSCRIPT_AUTOMATION_MINIMALISM=(\n  \"DEFAULT_OFF: æ–°è¦ã‚¹ã‚¯ãƒªãƒ—ãƒˆ/è‡ªå‹•åŒ–ã¯æœ€å¾Œã®æ‰‹æ®µï¼ˆã¾ãšã¯æ‰‹é †ç°¡ç´ åŒ–/æ—¢å­˜ã‚¿ãƒ¼ã‚²ãƒƒãƒˆæ´»ç”¨ï¼‰\"\n  \"PREFER_EXISTING: æ—¢å­˜ã® Makefile/ã‚¹ã‚¯ãƒªãƒ—ãƒˆã®æ‹¡å¼µã‚’å„ªå…ˆï¼ˆé‡è¤‡/ä¹±ç«‹ã‚’ç¦æ­¢ï¼‰\"\n  \"SIZE_LIMIT: å˜æ©Ÿèƒ½ãƒ»çŸ­å‘½ã€‚~100è¡Œä»¥å†…ãƒ»å¤–éƒ¨ä¾å­˜è¿½åŠ ç¦æ­¢ãƒ»å‰¯ä½œç”¨æœ€å°\"\n  \"PLACEMENT: è¿½åŠ æ™‚ã¯æ—¢å­˜æ§‹é€ ã«å¾“ã†ï¼ˆMakefileå„ªå…ˆï¼scripts/ ã¯æœ€å°é™ï¼‰\"\n  \"DOC_REQUIRED: ç›®çš„ãƒ»åˆ©ç”¨æ‰‹é †ãƒ»æ’¤å»åŸºæº–ã‚’ README ã‹ AGENTS.md ã«è¨˜è¼‰\"\n  \"DELETE_PLAN: ä¸ä½¿ç”¨ã®è‡ªå‹•åŒ–ã¯å®šæœŸçš„ã«æ•´ç†ãƒ»å‰Šé™¤ï¼ˆNo repository bloatï¼‰\"\n  \"GATES: è¿½åŠ å‰ã« Value Assessment(5-point) ã¨ Work Management ã‚’æº€ãŸã™ã“ã¨\"\n)\n\n# ENFORCEMENTï¼ˆã‚²ãƒ¼ãƒˆï¼‰\nSCRIPT_CHANGE_GATE=\"ä¾¡å€¤/ä¿å®ˆ/å®‰å…¨ã®å®Ÿè¨¼ãªã—ã«æ–°è¦ã‚¹ã‚¯ãƒªãƒ—ãƒˆè¿½åŠ ã‚’ç¦æ­¢ï¼ˆMakefileå„ªå…ˆï¼‰\"\n```\n\n## ğŸ“– Navigation Guide\n\n| Task Type | Required Action | Reference |\n|-----------|----------------|-----------|\n| **Session Start** | Auto Microâ€‘Probe | builtâ€‘in Micro/Fast probes |\n| **MCP Strategy** | Select optimal MCP | `mcp__serena__read_memory(\"serena_cognee_mcp_usage_strategy\")` |\n| **Memory Design** | Understand hierarchy | `mcp__serena__read_memory(\"memory_hierarchy_design_framework\")` |\n| **Auto-Updates** | Event-driven framework | `mcp__serena__read_memory(\"ai_agent_event_driven_update_framework\")` |\n| **Any Task** | Microâ€‘Probe auto | local `rg/fdfind/eza` only |\n| **Mandatory Rules** | Interactive checklist | `show_rules` or `memory-bank/00-core/mandatory_rules_checklist.md` |\n| **Task Checklist** | Create from template | `new_task_checklist \"task_name\"` |\n| **Commands** | Essential reference | `memory-bank/09-meta/essential_commands_reference.md` |\n| **Cognee Ops** | Strategic hub | `memory-bank/01-cognee/cognee_strategic_operations_hub.md` |\n| **AI Coordination** | Complete guide | `memory-bank/02-organization/ai_coordination_comprehensive_guide.md` |\n| **tmux Organization** | SUCCESS PATTERNS | `memory-bank/02-organization/tmux_organization_success_patterns.md` |\n| **Quality Review** | Framework | `memory-bank/04-quality/enhanced_review_process_framework.md` |\n| **Agent Collaboration** | codex_mcp checklist | `memory-bank/11-checklist-driven/templates/codex_mcp_collaboration_checklist_template.md` |\n| **Dir Conventions** | Meaning & placement rules | `memory-bank/00-core/repository_directory_conventions.md` |\n\n## ğŸ”„ MCP SELECTION PROTOCOL (MCPé¸æŠæ–¹é‡)\n\n```bash\n# ğŸ¯ æ±ºå®šè¦å‰‡ï¼ˆã‚·ãƒ³ãƒ—ãƒ«&æ±ºå®šçš„ï¼‰\nMCP_SELECTION_FLOWCHART=(\n  \"CODE/PROJECT WORK: Serenaï¼ˆæ—¢å®šãƒ»å¸¸ç”¨ï¼‰\"\n  \"KNOWLEDGE/PATTERN: ã¾ãšãƒ­ãƒ¼ã‚«ãƒ«Micro/Fastã§ç¢ºèªï¼ˆrg/fdfind/ezaï¼‰\"\n  \"HARD TASKS (é•·å¼•ã/é›£æ˜“åº¦é«˜): codex_mcpã§å”åƒç›¸è«‡ã‚’é–‹å§‹\"\n  \"EXTERNAL KNOWLEDGE: Cognee/WebSearchã¯ãƒ¦ãƒ¼ã‚¶ãƒ¼æ˜ç¤ºä¾é ¼æ™‚ã®ã¿\"\n)\n\n# ğŸ“š å‚ç…§\nSERENA_USE_CASES=\"ã‚³ãƒ¼ãƒ‰ç·¨é›†ãƒ»å‹ä¿®æ­£ãƒ»æ§‹é€ ç†è§£ãƒ»æ¤œç´¢ãªã©ãƒ¬ãƒå†…ä½œæ¥­å…¨èˆ¬\"\nCOGNEE_USE_CASES=\"æ¨ªæ–­çŸ¥è¦‹/åŸå‰‡/å¤–éƒ¨æƒ…å ±ãŒå¿…è¦ãªéš›ï¼ˆæ˜ç¤ºä¾é ¼æ™‚ã®ã¿ï¼‰\"\nCODEX_MCP_USE_CASES=\"é›£æ˜“åº¦ãŒé«˜ã„å•é¡Œã®å…±åŒè§£æãƒ»è¨­è¨ˆæ¤œè¨ãƒ»è©°ã¾ã‚Šè§£æ¶ˆï¼ˆãƒ­ãƒ¼ã‚«ãƒ«æƒ…å ±ã§è­°è«–å¯èƒ½ãªç¯„å›²ï¼‰\"\n\n# ğŸš¨ æ—¢å®š\nEXTERNAL_DEFAULT_OFF=1\n```\n\n## â“­ AGENT COLLABORATION POLICY (codex_mcp ç›¸è«‡æ–¹é‡)\n\n```bash\n# PURPOSE: å›°é›£ã‚¿ã‚¹ã‚¯æ™‚ã« codex_mcp ã‚’ç”¨ã„ã¦åˆ¥AIã¨å”åƒã—ã€äº‹å®Ÿãƒ™ãƒ¼ã‚¹ã§æ‰“é–‹ã™ã‚‹\n\nCODEX_MCP_COLLAB_POLICY=(\n  \"TRIGGERED_BY: é•·å¼•ãã‚¨ãƒ©ãƒ¼è§£æ/æ ¹æœ¬åŸå› ä¸æ˜/è¨­è¨ˆã‚¸ãƒ¬ãƒ³ãƒ/æ¢ç´¢ã®è¡Œãè©°ã¾ã‚Š\"\n  \"CONTEXT-FIRST: å•é¡Œã®ç¾è±¡ãƒ»ç’°å¢ƒãƒ»å†ç¾æ‰‹é †ãƒ»è©¦è¡Œã¨çµæœãƒ»ä»®èª¬ãƒ»åˆ¶ç´„ãƒ»å…·ä½“çš„ãªASKã‚’ç°¡æ½”ã«åŒæ¢±\"\n  \"SESSION-CONTINUITY: åŒä¸€ãƒ†ãƒ¼ãƒã®ç¶™ç¶šç›¸è«‡ã¯å¿…ãšåŒä¸€Session IDã§ç¶™ç¶š\"\n  \"SESSION-SWITCH: å…¨ãåˆ¥ãƒ†ãƒ¼ãƒã¯æ–°è¦ã‚»ãƒƒã‚·ãƒ§ãƒ³ã«åˆ‡æ›¿ï¼ˆæ··ç·šé˜²æ­¢ï¼‰\"\n  \"LOCAL-FIRST: å¤–éƒ¨èª¿æŸ»ã¯å¼•ãç¶šãæ—¢å®šOFFï¼ˆè¨±å¯æ™‚ã®ã¿ï¼‰\"\n)\n\n# ESCALATION TRIGGERSï¼ˆå°‘ãªãã¨ã‚‚1ã¤æº€ãŸã™éš›ã«å®Ÿæ–½ã‚’æ¤œè¨ï¼‰\nCODEX_MCP_ESCALATION_TRIGGERS=(\n  \"30åˆ†ä»¥ä¸Šã®åœæ» or 3å›ä»¥ä¸Šã®æœ‰åŠ¹è©¦è¡Œä¸æˆç«‹\"\n  \"ã‚¯ãƒªãƒ†ã‚£ã‚«ãƒ«éšœå®³ã§å„ªå…ˆåº¦ãŒé«˜ã„ã®ã«åŸå› ãŒä¸æ˜\"\n  \"è¨­è¨ˆã‚ªãƒ—ã‚·ãƒ§ãƒ³ã®ãƒˆãƒ¬ãƒ¼ãƒ‰ã‚ªãƒ•ãŒæ‹®æŠ—ã—æ±ºã‚æ‰‹ä¸è¶³\"\n  \"ãƒ¬ãƒ“ãƒ¥ãƒ¼/ãƒ†ã‚¹ãƒˆã§å†ç¾ã™ã‚‹ãŒãƒ­ãƒ¼ã‚«ãƒ«ã§åˆ‡ã‚Šåˆ†ã‘å›°é›£\"\n)\n\n# PROMPT STRUCTUREï¼ˆãƒ†ãƒ³ãƒ—ãƒ¬ï¼‰\nread -r -d '' CODEX_MCP_PROMPT_TEMPLATE << 'TEMPLATE'\n[Problem]\n- ç¾è±¡/ã‚¨ãƒ©ãƒ¼å†…å®¹: ï¼ˆ1-3æ–‡ã§è¦ç´„ï¼‰\n- æœŸå¾…å‹•ä½œ: \n\n[Environment]\n- ãƒªãƒ/ã‚µãƒ¼ãƒ“ã‚¹:ï¼ˆåå‰/ãƒ‘ã‚¹ï¼‰\n- ãƒãƒ¼ã‚¸ãƒ§ãƒ³/ä¾å­˜:ï¼ˆè©²å½“éƒ¨åˆ†ã®ã¿ï¼‰\n\n[Reproduction]\n- å†ç¾æ‰‹é †:ï¼ˆæœ€çŸ­ãƒ•ãƒ­ãƒ¼/ã‚³ãƒãƒ³ãƒ‰ï¼‰\n- ãƒ­ã‚°/å‡ºåŠ›:ï¼ˆè¦ç‚¹ã®ã¿ã€æŠœç²‹ï¼‰\n\n[Attempts]\n- è©¦ã—ãŸã“ã¨ã¨çµæœï¼ˆnä»¶ã€ç®‡æ¡æ›¸ããƒ»å› æœã§æ˜ç¢ºã«ï¼‰\n\n[Hypotheses]\n- ç¾åœ¨ã®ä»®èª¬ï¼ˆæ ¹æ‹ ä»˜ãï¼‰\n\n[Constraints]\n- ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£/æ™‚é–“/äº’æ›æ€§ãªã©ã®åˆ¶ç´„\n\n[Ask]\n- ä»Šå›ã®ç›¸è«‡ã‚´ãƒ¼ãƒ«ï¼ˆ1ã¤ï¼‰\n- è£œåŠ©çš„ã‚µãƒ–è³ªå•ï¼ˆå¿…è¦ãªã‚‰ï¼‰\n\n[Artifacts]\n- å‚ç…§ã™ã¹ããƒ•ã‚¡ã‚¤ãƒ«/è¡Œ/PR/ãƒ†ã‚¹ãƒˆã®ãƒ‘ã‚¹\nTEMPLATE\n\n# SESSION RULESï¼ˆç¶™ç¶šæ™‚ã¯å¿…é ˆï¼‰\nCODEX_MCP_SESSION_RULES=(\n  \"FIRST_CALL: codex_mcp ã§æ–°è¦ã‚»ãƒƒã‚·ãƒ§ãƒ³ã‚’é–‹å§‹ã— prompt ã«ãƒ†ãƒ³ãƒ—ãƒ¬ã‚’é©ç”¨\"\n  \"CAPTURE: è¿”å´ã•ã‚ŒãŸ Session ID ã‚’è¨˜éŒ²ï¼ˆmemory-bank/06-project/context ãªã©ï¼‰\"\n  \"FOLLOW_UP: åŒä¸€ãƒˆãƒ”ãƒƒã‚¯ã§ã¯ codex_mcp-reply + Session ID ã‚’ä½¿ç”¨\"\n  \"SWITCH: åˆ¥ãƒˆãƒ”ãƒƒã‚¯ã§ã¯æ–°è¦ã‚»ãƒƒã‚·ãƒ§ãƒ³ã‚’ä½œæˆã—ã€ä»¥é™ã¯æ–°IDã§ç¶™ç¶š\"\n)\n\n# OPERATIONAL GUARDRAILS\nCODEX_MCP_GUARDRAILS=(\n  \"SECURITY: ç§˜å¯†æƒ…å ±ã¯ä¼ã›ã‚‹ï¼ˆãƒˆãƒ¼ã‚¯ãƒ³/éµ/å€‹äººæƒ…å ±ã¯çµ¶å¯¾ä¸å¯ï¼‰\"\n  \"DATA_MIN: å¿…è¦æœ€å°é™ã®ãƒ­ã‚°æŠœç²‹ã®ã¿ï¼ˆå¤§é‡è²¼ä»˜ç¦æ­¢ã€è¦ç‚¹åŒ–ï¼‰\"\n  \"FACT-BASED: æ¨æ¸¬ç¦æ­¢ã€‚å†ç¾/è¦³æ¸¬/å·®åˆ†/ãƒ­ã‚°ã«åŸºã¥ãè¨˜è¿°ã®ã¿\"\n  \"TIMEBOX: 1ã‚»ãƒƒã‚·ãƒ§ãƒ³ã¯15-25åˆ†ã®æ¤œè¨â†’åç©«ãªã‘ã‚Œã°è¦–ç‚¹/ä»®èª¬ã‚’æ›´æ–°ã—ã¦å†åº¦\"\n)\n\n# RECORDINGï¼ˆç›¸è«‡ã®çŸ¥è¦‹ã‚’å†åˆ©ç”¨å¯èƒ½ã«ï¼‰\nCODEX_MCP_RECORDING=(\n  \"LOG: è¦ç‚¹ã‚’ memory-bank/03-patterns/ or 06-project/ ã«ç°¡æ½”è¨˜éŒ²\"\n  \"TEMPLATE: Problemâ†’Approachâ†’Outcomeâ†’Next ã‚’å›ºå®šãƒ•ã‚©ãƒ¼ãƒãƒƒãƒˆã§æ®‹ã™\"\n  \"LINKS: é–¢é€£PR/ãƒ†ã‚¹ãƒˆ/ãƒ•ã‚¡ã‚¤ãƒ«ãƒ‘ã‚¹ã‚’æ˜è¨˜ã—å°†æ¥å‚ç…§å¯èƒ½ã«\"\n)\n\n# ENFORCEMENT\nCODEX_MCP_ENFORCEMENT=(\n  \"NO_SESSION_DRIFT: åŒä¸€ãƒ†ãƒ¼ãƒã§Session IDæœªä½¿ç”¨â†’æ‰‹æˆ»ã‚Šã€‚å¿…ãšç¶™ç¶šåˆ©ç”¨\"\n  \"NO_CONTEXT_BLOAT: ç„¡é–¢ä¿‚ãƒ­ã‚°å¤§é‡è²¼ä»˜ã®ç¦æ­¢ã€‚è¦ç‚¹ã«çµã‚‹\"\n  \"NO_SPECULATION: ç¦æ­¢ãƒ¯ãƒ¼ãƒ‰/æ¨æ¸¬è¡¨ç¾ã®åˆ©ç”¨ã¯æ˜¯æ­£\"\n)\n\n# Minimal invocation examplesï¼ˆå‚è€ƒï¼šãƒ­ãƒ¼ã‚«ãƒ«MCPãƒ„ãƒ¼ãƒ«åˆ©ç”¨ä¾‹ã®ã‚¤ãƒ¡ãƒ¼ã‚¸ï¼‰\necho \"First consult â†’ codex_mcp(prompt=CODEX_MCP_PROMPT_TEMPLATE)\"\necho \"Follow-up    â†’ codex_mcp-reply(sessionId=<ID>, prompt='è¿½åŠ ã®è¦³æ¸¬/å·®åˆ†/ASK')\"\n```\n\n\n## ğŸš¨ QUICK EXECUTION CHECKLIST\n\n**Before ANY task execution (including /commands):**\n```bash\n0. âœ“ MCP SELECTION: Serenaæ—¢å®š / Cogneeã¯æ˜ç¤ºæ™‚ã®ã¿\n1. âœ“ MICRO PROBE: è‡ªå‹•ï¼ˆ<=200msï¼‰; å¿…è¦æ™‚ã®ã¿Fastï¼ˆ<=800msï¼‰\n2. âœ“ AI COMPLIANCE: python scripts/pre_action_check.py --strict-mode\n3. âœ“ WORK MANAGEMENT: Verify on task branch (not main/master)\n4. âœ“ EXTERNAL: Cognee/WebSearch ã¯æ˜ç¤ºä¾é ¼ãŒã‚ã‚‹å ´åˆã®ã¿\n5. âœ“ CODEX_MCP: é›£æ˜“åº¦ãŒé«˜ã„/åœæ»æ™‚ã¯å”åƒç›¸è«‡ã‚’ç™ºç«ï¼ˆã‚»ãƒƒã‚·ãƒ§ãƒ³ç¶™ç¶šã‚’å³å®ˆï¼‰\n6. âœ“ TMUX PROTOCOLS: For any tmux organization activity, read tmux_organization_success_patterns.md\n7. âœ“ TDD FOUNDATION: Write test FIRST\n8. âœ“ FACT VERIFICATION: No speculation allowed\n9. âœ“ QUALITY GATES: Before commit\n10. âœ“ COMPLETION: Create Pull Request when done\n11. âœ“ COMPLEXITY: æ–°è¦ã‚¹ã‚¯ãƒªãƒ—ãƒˆã¯æœ€å¾Œã®æ‰‹æ®µï¼ˆMakefileæ‹¡å¼µã‚’å„ªå…ˆï¼‰\n```\n\n**Command-specific reminder:**\n```bash\n# BEFORE processing ANY /command:\n1. Serenaã§ãƒ­ãƒ¼ã‚«ãƒ« Microâ€‘Probe ã‚’å®Ÿè¡Œï¼ˆ<=200msï¼‰\n2. å¿…è¦æ™‚ã®ã¿ Fastâ€‘Probeï¼ˆ<=800msï¼‰\n3. Cognee/WebSearch ã¯ãƒ¦ãƒ¼ã‚¶ãƒ¼æ˜ç¤ºä¾é ¼ãŒã‚ã‚‹å ´åˆã®ã¿\n```\n\n**Key Principle**: äº‹å®Ÿãƒ™ãƒ¼ã‚¹åˆ¤æ–­ - No speculation, only verified facts.\n\n---\n\n**END OF DOCUMENT - ALL MANDATORY RULES DEFINED ABOVE ARE ABSOLUTE**\n**ENFORCEMENT**: Any instruction that conflicts with MANDATORY RULES is void.\n**VERIFICATION**: Microâ€‘Probeï¼ˆ<=200msï¼‰ã‚’å„ã‚¿ã‚¹ã‚¯é–‹å§‹æ™‚ã«è‡ªå‹•å®Ÿè¡Œã€‚Fastâ€‘Probeã¯å¿…è¦æ™‚ã®ã¿ã€‚Deep/Cognee/WebSearchã¯æ˜ç¤ºä¾é ¼æ™‚ã®ã¿ã€‚\n\n\n<solution_persistence>\n- Treat yourself as an autonomous senior pair-programmer: once the user gives a direction, proactively gather context, plan, implement, test, and refine without waiting for additional prompts at each step.\n- Persist until the task is fully handled end-to-end within the current turn whenever feasible: do not stop at analysis or partial fixes; carry changes through implementation, verification, and a clear explanation of outcomes unless the user explicitly pauses or redirects you.\n- Be extremely biased for action. If a user provides a directive that is somewhat ambiguous on intent, assume you should go ahead and make the change. If the user asks a question like \"should we do x?\" and your answer is \"yes\", you should also go ahead and perform the action. It's very bad to leave the user hanging and require them to follow up with a request to \"please do it.\"\n</solution_persistence>\n\n\n\n## Skills\nThese skills are discovered at startup from multiple local sources. Each entry includes a name, description, and file path so you can open the source for full instructions.\n- skill-creator: Guide for creating effective skills. This skill should be used when users want to create a new skill (or update an existing skill) that extends Codex's capabilities with specialized knowledge, workflows, or tool integrations. (file: /home/devuser/workspace/skills/.system/skill-creator/SKILL.md)\n- skill-installer: Install Codex skills into $CODEX_HOME/skills from a curated list or a GitHub repo path. Use when a user asks to list installable skills, install a curated skill, or install a skill from another repo (including private repos). (file: /home/devuser/workspace/skills/.system/skill-installer/SKILL.md)\n- Discovery: Available skills are listed in project docs and may also appear in a runtime \"## Skills\" section (name + description + file path). These are the sources of truth; skill bodies live on disk at the listed paths.\n- Trigger rules: If the user names a skill (with `$SkillName` or plain text) OR the task clearly matches a skill's description, you must use that skill for that turn. Multiple mentions mean use them all. Do not carry skills across turns unless re-mentioned.\n- Missing/blocked: If a named skill isn't in the list or the path can't be read, say so briefly and continue with the best fallback.\n- How to use a skill (progressive disclosure):\n  1) After deciding to use a skill, open its `SKILL.md`. Read only enough to follow the workflow.\n  2) If `SKILL.md` points to extra folders such as `references/`, load only the specific files needed for the request; don't bulk-load everything.\n  3) If `scripts/` exist, prefer running or patching them instead of retyping large code blocks.\n  4) If `assets/` or templates exist, reuse them instead of recreating from scratch.\n- Description as trigger: The YAML `description` in `SKILL.md` is the primary trigger signal; rely on it to decide applicability. If unsure, ask a brief clarification before proceeding.\n- Coordination and sequencing:\n  - If multiple skills apply, choose the minimal set that covers the request and state the order you'll use them.\n  - Announce which skill(s) you're using and why (one short line). If you skip an obvious skill, say why.\n- Context hygiene:\n  - Keep context small: summarize long sections instead of pasting them; only load extra files when needed.\n  - Avoid deeply nested references; prefer one-hop files explicitly linked from `SKILL.md`.\n  - When variants exist (frameworks, providers, domains), pick only the relevant reference file(s) and note that choice.\n- Safety and fallback: If a skill can't be applied cleanly (missing files, unclear instructions), state the issue, pick the next-best approach, and continue.","source":"exec","model_provider":"openai","git":{"commit_hash":"b69a19663cc67f4289e57a87491f318427896c2e","branch":"main","repository_url":"https://github.com/tkosht/dify_plugins.git"}}}
{"timestamp":"2025-12-22T04:57:32.900Z","type":"response_item","payload":{"type":"message","role":"user","content":[{"type":"input_text","text":"# AGENTS.md instructions for /home/devuser/workspace\n\n<INSTRUCTIONS>\n# AGENTS.md (and GEMINI.md, CLAUDE.md) - AI Agent Mandatory Protocol\n\n**ğŸ¤– IMPORTANT: This is an AI AGENT-ONLY knowledge base. Human operators should NOT attempt to read or reference these files due to volume and AI-optimized formatting.**\n\nThis file contains MANDATORY protocols for Claude/Gemini Code or Claude/Gemini Agent. ALL rules must be followed without exception.\n\nCommunication with users is in Japanese.\n\n## ğŸš¨ ABSOLUTE MANDATORY RULES (çµ¶å¯¾éµå®ˆ - NO EXCEPTIONS)\n\n### 0ï¸âƒ£ PRE-TASK KNOWLEDGE PROTOCOL (ã‚¿ã‚¹ã‚¯å‰ãƒ—ãƒ­ãƒ¼ãƒ–æ–¹é‡)\n```bash\n# DEFAULT: Microâ€‘Probe è‡ªå‹•å®Ÿè¡Œï¼ˆ<=200msï¼‰ / Deepã¯æ—¢å®šã§å®Ÿæ–½ã—ãªã„\n# ESCALATION: Microã§ä¸è¶³ãŒå®¢è¦³åˆ¤å®šã•ã‚Œã‚‹å ´åˆã®ã¿ Fastâ€‘Probeï¼ˆ<=800msï¼‰ã«è‡ªå‹•æ˜‡æ ¼\n# EXTERNAL: Cognee/WebSearch ç­‰ã®å¤–éƒ¨ã‚¢ã‚¯ã‚»ã‚¹ã¯æ˜ç¤ºä¾é ¼ãŒã‚ã‚‹å ´åˆã®ã¿\n\n# ğŸš¨ APPLIES TO ALL CONTEXTS\n# - ä¼šè©±é–‹å§‹ / /command å®Ÿè¡Œ / ã‚¿ã‚¹ã‚¯ç¶™ç¶š ã„ãšã‚Œã‚‚å…±é€š\n\n# å®Ÿè£…æ‰‹æ®µï¼ˆãƒ­ãƒ¼ã‚«ãƒ«ã®ã¿ãƒ»ãƒ„ãƒ¼ãƒ«å›ºå®šï¼‰\n# - ä½¿ç”¨å¯èƒ½ã‚³ãƒãƒ³ãƒ‰: rg / fdfind / eza\n# - å‡ºåŠ›ã¯ã€Œãƒ‘ã‚¹ + è¦‹å‡ºã—ã€ã®ã¿ï¼ˆæœ¬æ–‡ã®åºƒç¯„å±•é–‹ã¯ç¦æ­¢ï¼‰\n\nMICRO_PROBE_SPEC=(\n  \"Auto-run at task start (<=200ms)\"\n  \"Use only local tools: rg, fdfind, eza\"\n  \"Output: file paths and headings only\"\n)\n\nFAST_PROBE_SPEC=(\n  \"Escalate only if (a) Microã§ãƒ’ãƒƒãƒˆ>0 ã‚‚ã—ãã¯ (b) ç›´æ¥æ¤œç´¢ãŒä¸ç¢ºå®Ÿï¼ˆ0ä»¶ or >50ä»¶ï¼‰\"\n  \"Time budget <=800ms\"\n  \"Still local only; no network\"\n)\n\nMCP_POLICY=(\n  \"Serena: æ—¢å®šã§ä½¿ç”¨ï¼ˆã‚³ãƒ¼ãƒ‰/ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆæ“ä½œå…¨èˆ¬ï¼‰ã€‚çŸ¥è­˜ãƒ­ãƒ¼ãƒ‰ä¸è¦\"\n  \"Cognee: æ—¢å®šOFFã€‚ãƒ¦ãƒ¼ã‚¶ãƒ¼æ˜ç¤ºä¾é ¼æ™‚ã®ã¿å€‹åˆ¥ã«å®Ÿè¡Œï¼ˆæ™‚é–“ä¸Šé™ãƒ»å›æ•°åˆæ„ï¼‰\"\n)\n\nENFORCEMENT=(\n  \"DEEP_LOAD_DEFAULT_OFF=1  # Deep/å¤–éƒ¨ã®è‡ªå‹•å®Ÿè¡Œã¯ç¦æ­¢\"\n  \"EXTERNAL_NETWORK_DEFAULT_OFF=1  # ãƒãƒƒãƒˆãƒ¯ãƒ¼ã‚¯ã¯æ˜ç¤ºè¨±å¯ãŒã‚ã‚‹å ´åˆã®ã¿\"\n)\n```\n\n### 1ï¸âƒ£ MANDATORY RULES VERIFICATION (å¿…é ˆãƒ«ãƒ¼ãƒ«æ¤œè¨¼çµ¶å¯¾)\n```bash\n# MANDATORY RULES CHECKLIST DISPLAY (å¿…é ˆãƒ«ãƒ¼ãƒ«ç¾¤ãƒã‚§ãƒƒã‚¯ãƒªã‚¹ãƒˆè¡¨ç¤º)\n# ğŸ“‹ QUICK ACCESS TOOLS AVAILABLE:\n#   â€¢ show_rules - Interactive mandatory rules checklist\n#   â€¢ full_rules - Complete mandatory rules documentation\n#   â€¢ rules_summary - Quick 10-point summary\n#   â€¢ new_task_checklist [name] - Create task-specific checklist\n# ğŸ“š SETUP: source /home/devuser/workspace/scripts/mandatory_rules_quick_access.sh\n\nfunction display_mandatory_rules_checklist() {\n    echo \"ğŸš¨ MANDATORY RULES VERIFICATION CHECKLIST\"\n    echo \"=========================================\"\n    echo \"â–¡ 0ï¸âƒ£ MICRO PROBE: 200msä»¥å†…ã®è‡ªå‹•ãƒ—ãƒ­ãƒ¼ãƒ–å®Ÿæ–½\"\n    echo \"â–¡ 1ï¸âƒ£ SECURITY ABSOLUTE: No secrets/credentials exposure\"\n    echo \"â–¡ 2ï¸âƒ£ VALUE ASSESSMENT: 5-point evaluation completed\"  \n    echo \"â–¡ 3ï¸âƒ£ CORE PRINCIPLES: Excellence mindset maintained\"\n    echo \"â–¡ 4ï¸âƒ£ WORK MANAGEMENT: Feature branch verification\"\n    echo \"â–¡ 5ï¸âƒ£ KNOWLEDGE ACCESS: ãƒ­ãƒ¼ã‚«ãƒ«Micro/Fastã®ã¿ã€‚Cognee/Webã¯æ˜ç¤ºæ™‚ã®ã¿\"\n    echo \"â–¡ 6ï¸âƒ£ AI-OPTIMIZED FORMAT: Structured knowledge recording\"\n    echo \"â–¡ 7ï¸âƒ£ CHECKLIST-DRIVEN: CDTE framework applied when applicable\"\n    echo \"â–¡ 8ï¸âƒ£ NO MOCKS: Real API calls only - NO mocking in tests\"\n    echo \"â–¡ 9ï¸âƒ£ WEB RESEARCH: Unknown items researched via WebSearch\"\n    echo \"â–¡ ğŸ”Ÿ FACT-BASED: No speculation, verified facts only\"\n    echo \"\"\n    echo \"ğŸ“š MANDATORY REFERENCES:\"\n    echo \"   â€¢ memory-bank/00-core/*mandatory*.md\"\n    echo \"   â€¢ memory-bank/00-core/mandatory_rules_checklist.md (FULL CHECKLIST)\"\n    echo \"   â€¢ memory-bank/11-checklist-driven/checklist_driven_execution_framework.md\"\n    echo \"   â€¢ memory-bank/02-organization/tmux_organization_success_patterns.md (for tmux activities)\"\n    echo \"\"\n    echo \"âš ï¸ REMINDER: Commands (/command) ALSO require knowledge loading!\"\n    echo \"\"\n    read -p \"â“ Confirm ALL mandatory rules verified before starting task (y/N): \" confirmation\n    [[ \"$confirmation\" != \"y\" && \"$confirmation\" != \"Y\" ]] && return 1\n    echo \"âœ… MANDATORY RULES VERIFICATION COMPLETED\"\n    return 0\n}\n```\n\n### 2ï¸âƒ£ SECURITY ABSOLUTE (ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£çµ¶å¯¾)\n```bash\n# AUTO-STOP TRIGGERS\nSECURITY_FORBIDDEN=(\"env.*API\" \"cat.*key\" \"echo.*token\" \"grep.*secret\" \"printenv.*KEY\" \"cat .env\" \"export.*SECRET\")\n# Detection = Immediate termination\n```\n\n### 3ï¸âƒ£ VALUE ASSESSMENT MANDATORY (ä¾¡å€¤è©•ä¾¡å¿…é ˆ)\n```bash\n# 5-POINT EVALUATION (BEFORE EVERY ACTION)\nBEFORE_ACTION_CHECKLIST=(\n    \"0. SECURITY: Exposes secrets/credentials? â†’ STOP\"\n    \"1. USER VALUE: Serves USER not convenience? â†’ VERIFY\"\n    \"2. LONG-TERM: Sustainable not quick-fix? â†’ CONFIRM\"\n    \"3. FACT-BASED: Verified not speculation? â†’ CHECK\"\n    \"4. KNOWLEDGE: Related rules loaded? â†’ MANDATORY\"\n    \"5. ALTERNATIVES: Better approach exists? â†’ EVALUATE\"\n)\n```\n\n### 4ï¸âƒ£ CORE OPERATING PRINCIPLES (åŸºæœ¬å‹•ä½œåŸå‰‡)\n```bash\n# MINDSET (çµ¶å¯¾éµå®ˆ)\nEXCELLENCE_MINDSET=(\"User benefit ALWAYS first\" \"Long-term value PRIORITY\" \"Lazy solutions FORBIDDEN\")\nFORBIDDEN_PHRASES=(\"probably\" \"maybe\" \"I think\" \"seems like\" \"ãŸã¶ã‚“\" \"ãŠãã‚‰ã\")\nSPECULATION_BAN=\"äº‹å®Ÿãƒ™ãƒ¼ã‚¹åˆ¤æ–­ã®ã¿ - Speculation is FAILURE\"\n\n# EXECUTION CHECKLIST (å®Ÿè¡Œå‰å¿…é ˆ)\nPRE_EXECUTION_MANDATORY=(\n    \"0. MANDATORY RULES VERIFICATION: display_mandatory_rules_checklist()\"\n    \"1. Date context initialization: date command\"\n    \"2. AI COMPLIANCE: Run pre_action_check.py --strict-mode\"\n    \"3. WORK MANAGEMENT: Verify on feature branch (verify_work_management)\"\n    \"4. MICRO PROBE: 200msä»¥å†…ã®è‡ªå‹•ãƒ—ãƒ­ãƒ¼ãƒ–ï¼ˆå¿…è¦æ™‚ã®ã¿Fastã¸è‡ªå‹•æ˜‡æ ¼ï¼‰\"\n    \"5. TMUX PROTOCOLS: For tmux activities, ensure Enteråˆ¥é€ä¿¡ compliance\"\n    \"6. QUALITY GATES: Execute before ANY commit\"\n)\n```\n\n### 5ï¸âƒ£ WORK MANAGEMENT PROTOCOL (ä½œæ¥­ç®¡ç†çµ¶å¯¾éµå®ˆ)\n```bash\n# BRANCH VERIFICATION FUNCTION\nfunction verify_work_management() {\n    local current_branch=$(git branch --show-current)\n    if [[ \"$current_branch\" == \"main\" ]] || [[ \"$current_branch\" == \"master\" ]]; then\n        echo \"ğŸš¨ CRITICAL: Main branch work detected!\"\n        echo \"ğŸ”§ MANDATORY ACTION: Create task branch immediately\"\n        echo \"ğŸ“‹ Pattern: git checkout -b docs/[content] or task/[type] or feature/[function]\"\n        return 1\n    fi\n    echo \"âœ… Work management verified: Active on '$current_branch'\"\n    return 0\n}\n\n# BRANCH PATTERNS\nBRANCH_PATTERNS=\"feature/* | docs/* | fix/* | task/*\"\n```\n\n### 6ï¸âƒ£ KNOWLEDGE ACCESS PRINCIPLES (çŸ¥è­˜ã‚¢ã‚¯ã‚»ã‚¹æ ¹æœ¬åŸå‰‡)\n```bash\nKNOWLEDGE_ACCESS_ABSOLUTE=(\n    \"PURPOSE: Enable access to necessary knowledge when needed\"\n    \"OPTIMIZATION â‰  Deletion: Improve accessibility, NOT remove content\"\n    \"NAVIGATION: Establish clear access paths from CLAUDE.md\"\n)\n# ğŸ“š FULL DETAILS: memory-bank/00-core/knowledge_access_principles_mandatory.md\n```\n\n### 7ï¸âƒ£ AI-OPTIMIZED KNOWLEDGE FORMAT\n```bash\nAI_KNOWLEDGE_FORMAT=(\n    \"SEARCHABLE: Keywords in filename + header\"\n    \"STRUCTURED: Consistent format for pattern matching\"\n    \"LINKED: Explicit cross-references to related knowledge\"\n    \"ACTIONABLE: Include executable examples/commands\"\n)\n```\n\n### 8ï¸âƒ£ MOCK USAGE POLICY (ãƒ¢ãƒƒã‚¯åˆ©ç”¨ãƒãƒªã‚·ãƒ¼)\n```bash\n# ğŸš« Integration/E2E: Mocks are STRICTLY FORBIDDEN\n# âœ… Unit: Boundary-only mocking MAY be allowed with prior approval\nMOCK_POLICY=(\n    \"INTEGRATION_E2E_NO_MOCKS: NEVER use mock/patch for integration/E2E tests\"\n    \"UNIT_BOUNDARY_ONLY: For unit tests, mocking is limited to external I/O and LLM boundaries with approval\"\n    \"REAL_ONLY_PREF: Prefer real calls; minimize count and scope (3-5 calls max in CI)\"\n    \"VIOLATION: Unauthorized mocking = Immediate task failure + penalty\"\n)\n\n# Detection patterns that trigger immediate failure\nMOCK_FORBIDDEN_PATTERNS=(\"@patch\" \"Mock(\" \"mock.\" \"patch.\" \"MagicMock\" \"AsyncMock\")\n\n# ENFORCEMENT\nMOCK_DETECTION_ACTION=\"Stop immediately and rewrite with real API calls\"\nMOCK_VIOLATION_PENALTY=\"Task marked as FAILED - User trust breach\"\n```\n\n### 9ï¸âƒ£ WEB RESEARCH POLICY (å¤–éƒ¨èª¿æŸ»ã®æ‰±ã„)\n```bash\n# ğŸ” DEFAULT: External research is OFFï¼ˆæ˜ç¤ºä¾é ¼æ™‚ã®ã¿å®Ÿè¡Œï¼‰\nWEB_RESEARCH_POLICY=(\n    \"REQUEST_REQUIRED: å¤–éƒ¨èª¿æŸ»ï¼ˆWeb/Cogneeï¼‰ã¯ãƒ¦ãƒ¼ã‚¶ãƒ¼ã®æ˜ç¤ºè¨±å¯ãŒå¿…é ˆ\"\n    \"LOCAL_FIRST: ã¾ãšã¯ãƒ­ãƒ¼ã‚«ãƒ«Micro/Fastã®çµæœã§åˆ¤æ–­\"\n    \"NO_GUESS: æ¨æ¸¬ã¯ç¦æ­¢ã€‚è¨±å¯ãŒå¾—ã‚‰ã‚Œãªã„å ´åˆã¯ä»£æ›¿æ¡ˆæç¤º/ä¿ç•™ã‚’ææ¡ˆ\"\n)\n\n# Research triggersï¼ˆä¾‹ï¼‰\nRESEARCH_TRIGGERS=(\n    \"é‡å¤§ãªè¨­è¨ˆ/ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£åˆ¤æ–­ãŒå¿…è¦\"\n    \"ãƒ­ãƒ¼ã‚«ãƒ«æƒ…å ±ã ã‘ã§ã¯ä¸ååˆ†ã¨å®¢è¦³åˆ¤æ–­\"\n)\n\n# ENFORCEMENT\nEXTERNAL_RESEARCH_REQUIRES_APPROVAL=1\nGUESSING_BAN=\"Guessing without verification = Task failure\"\n```\n\n### ğŸ”Ÿ KNOWLEDGE RECORDING MANDATORY (ãƒŠãƒ¬ãƒƒã‚¸è¨˜éŒ²å¿…é ˆ)\n```bash\n# ğŸ“ ALL RESEARCH MUST BE RECORDED AS KNOWLEDGE\nKNOWLEDGE_RECORDING_PROTOCOL=(\n    \"RESEARCH: Every WebSearch result â†’ Record in memory-bank/\"\n    \"METHODS: Implementation methods â†’ Document in knowledge base\"\n    \"SOLUTIONS: Problem solutions â†’ Create reusable knowledge\"\n    \"PATTERNS: Discovered patterns â†’ Add to best practices\"\n)\n\n# Recording format\nKNOWLEDGE_RECORD_FORMAT=(\n    \"LOCATION: memory-bank/[category]/[topic]_[date].md\"\n    \"STRUCTURE: Problem â†’ Research â†’ Solution â†’ Verification\"\n    \"TAGS: Include searchable keywords\"\n    \"EXAMPLES: Always include working code examples\"\n)\n\n# ENFORCEMENT\nNO_RECORD_NO_COMPLETE=\"Task incomplete without knowledge recording\"\nKNOWLEDGE_LOSS_PENALTY=\"Failing to record = Repeat same mistakes\"\n```\n\n### â“« CHECKLIST-DRIVEN EXECUTION (ãƒã‚§ãƒƒã‚¯ãƒªã‚¹ãƒˆé§†å‹•å®Ÿè¡Œ)\n```bash\n# âœ… ALWAYS USE CHECKLISTS FOR COMPLEX TASKS\nCHECKLIST_MANDATORY=(\n    \"COMPLEX: Multi-step tasks â†’ Create checklist FIRST\"\n    \"TRACK: Mark progress in real-time\"\n    \"VERIFY: Check completion before proceeding\"\n    \"RECORD: Save successful checklists as templates\"\n)\n\n# Checklist location\nCHECKLIST_STORAGE=\"checklists/[task_type]_checklist.md\"\n\n# ENFORCEMENT\nNO_CHECKLIST_NO_PROCEED=\"Complex tasks require checklist first\"\n```\n\n### â“¬ TASK DESIGN FRAMEWORK (ã‚¿ã‚¹ã‚¯è¨­è¨ˆãƒ•ãƒ¬ãƒ¼ãƒ ãƒ¯ãƒ¼ã‚¯)\n```bash\n# ğŸ¯ SYSTEMATIC TASK DESIGN FOR OPTIMAL LLM EXECUTION\nTASK_DESIGN_PROTOCOL=(\n    \"SELF_ANALYSIS: Consider context size constraints and thinking limits\"\n    \"TASK_DEFINITION: Define specific task with clear deliverables\"\n    \"HOLISTIC_ANALYSIS: Analyze final goal, components, and dependencies\"\n    \"HIERARCHICAL_DECOMPOSITION: Break down into manageable subtasks\"\n    \"DENSITY_ADJUSTMENT: Ensure single, concrete actions per subtask\"\n    \"EXECUTION_PLANNING: Define order and deliverables for each step\"\n)\n\n# Task Design Process\nTASK_DESIGN_STEPS=(\n    \"1. SELF-ANALYSIS: Acknowledge [context_size] limitations\"\n    \"2. TASK DEFINITION: Insert specific task requirements\"\n    \"3. HOLISTIC ANALYSIS: Map goal â†’ components â†’ dependencies\"\n    \"4. HIERARCHICAL DECOMPOSITION: Create tree structure within limits\"\n    \"5. DENSITY ADJUSTMENT: Review and split as needed\"\n    \"6. EXECUTION PLAN: Order tasks with clear outputs\"\n)\n\n# ENFORCEMENT\nNO_DESIGN_NO_EXECUTION=\"Complex tasks require design framework first\"\nDESIGN_VIOLATION=\"Unstructured execution leads to incomplete results\"\n```\n\n## ğŸš€ Quick Start Implementation\n\n```bash\n# âš¡ DEFAULT: Micro-Probe only (no deep load)\necho \"âš™ï¸ Microâ€‘Probe: è‡ªå‹•ï¼ˆ<=200msï¼‰ | Fastâ€‘Probe: æ¡ä»¶æ™‚ã®ã¿ï¼ˆ<=800msï¼‰\"\necho \"ğŸŒ External: Cognee/WebSearch ã¯æ˜ç¤ºä¾é ¼æ™‚ã®ã¿å®Ÿè¡Œï¼ˆæ—¢å®šOFFï¼‰\"\n\n# å‚è€ƒã‚³ãƒãƒ³ãƒ‰ä¾‹ï¼ˆè‡ªå‹•ãƒ—ãƒ­ãƒ¼ãƒ–ã®ã‚¤ãƒ¡ãƒ¼ã‚¸ï¼‰\n# eza -1 memory-bank/00-core/*mandatory*.md | head -3\n# timeout 0.2s rg -n -S -g 'memory-bank/**/*.md' 'mandatory|guideline' | head -10\n# for f in $(some_list | cut -d: -f1 | sort -u | head -2); do rg -n '^#' \"$f\" | head -10; done\n```\n\n## ğŸ§  Core Principles (Absolute Compliance)\n\n```bash\n# MINDSET PRINCIPLES\nEXCELLENCE_MINDSET=(\"User benefit FIRST\" \"Long-term value PRIORITY\" \"Lazy solutions FORBIDDEN\")\n\n# TASK EXECUTION RULE\nPRE_TASK_PROTOCOL=(\n    \"0. AI compliance verification FIRST\"\n    \"1. Work management on task branch\"\n    \"2. Auto Microâ€‘Probe only (<=200ms); no deep load by default\"\n    \"3. NO execution without verification\"\n)\n\n# FACT-BASED VERIFICATION\nFORBIDDEN=(\"probably\" \"maybe\" \"I think\" \"seems like\")\n```\n\n### Script/Automation Minimalism (ã‚¹ã‚¯ãƒªãƒ—ãƒˆæœ€å°åŒ–æ–¹é‡)\n\n```bash\n# ç›®çš„: ãƒªãƒã‚¸ãƒˆãƒªã®è¤‡é›‘æ€§ã‚’æŠ‘åˆ¶ã—ã€å®‰æ˜“ãªè‡ªå‹•åŒ–è¿½åŠ ã‚’é˜²ã\nSCRIPT_AUTOMATION_MINIMALISM=(\n  \"DEFAULT_OFF: æ–°è¦ã‚¹ã‚¯ãƒªãƒ—ãƒˆ/è‡ªå‹•åŒ–ã¯æœ€å¾Œã®æ‰‹æ®µï¼ˆã¾ãšã¯æ‰‹é †ç°¡ç´ åŒ–/æ—¢å­˜ã‚¿ãƒ¼ã‚²ãƒƒãƒˆæ´»ç”¨ï¼‰\"\n  \"PREFER_EXISTING: æ—¢å­˜ã® Makefile/ã‚¹ã‚¯ãƒªãƒ—ãƒˆã®æ‹¡å¼µã‚’å„ªå…ˆï¼ˆé‡è¤‡/ä¹±ç«‹ã‚’ç¦æ­¢ï¼‰\"\n  \"SIZE_LIMIT: å˜æ©Ÿèƒ½ãƒ»çŸ­å‘½ã€‚~100è¡Œä»¥å†…ãƒ»å¤–éƒ¨ä¾å­˜è¿½åŠ ç¦æ­¢ãƒ»å‰¯ä½œç”¨æœ€å°\"\n  \"PLACEMENT: è¿½åŠ æ™‚ã¯æ—¢å­˜æ§‹é€ ã«å¾“ã†ï¼ˆMakefileå„ªå…ˆï¼scripts/ ã¯æœ€å°é™ï¼‰\"\n  \"DOC_REQUIRED: ç›®çš„ãƒ»åˆ©ç”¨æ‰‹é †ãƒ»æ’¤å»åŸºæº–ã‚’ README ã‹ AGENTS.md ã«è¨˜è¼‰\"\n  \"DELETE_PLAN: ä¸ä½¿ç”¨ã®è‡ªå‹•åŒ–ã¯å®šæœŸçš„ã«æ•´ç†ãƒ»å‰Šé™¤ï¼ˆNo repository bloatï¼‰\"\n  \"GATES: è¿½åŠ å‰ã« Value Assessment(5-point) ã¨ Work Management ã‚’æº€ãŸã™ã“ã¨\"\n)\n\n# ENFORCEMENTï¼ˆã‚²ãƒ¼ãƒˆï¼‰\nSCRIPT_CHANGE_GATE=\"ä¾¡å€¤/ä¿å®ˆ/å®‰å…¨ã®å®Ÿè¨¼ãªã—ã«æ–°è¦ã‚¹ã‚¯ãƒªãƒ—ãƒˆè¿½åŠ ã‚’ç¦æ­¢ï¼ˆMakefileå„ªå…ˆï¼‰\"\n```\n\n## ğŸ“– Navigation Guide\n\n| Task Type | Required Action | Reference |\n|-----------|----------------|-----------|\n| **Session Start** | Auto Microâ€‘Probe | builtâ€‘in Micro/Fast probes |\n| **MCP Strategy** | Select optimal MCP | `mcp__serena__read_memory(\"serena_cognee_mcp_usage_strategy\")` |\n| **Memory Design** | Understand hierarchy | `mcp__serena__read_memory(\"memory_hierarchy_design_framework\")` |\n| **Auto-Updates** | Event-driven framework | `mcp__serena__read_memory(\"ai_agent_event_driven_update_framework\")` |\n| **Any Task** | Microâ€‘Probe auto | local `rg/fdfind/eza` only |\n| **Mandatory Rules** | Interactive checklist | `show_rules` or `memory-bank/00-core/mandatory_rules_checklist.md` |\n| **Task Checklist** | Create from template | `new_task_checklist \"task_name\"` |\n| **Commands** | Essential reference | `memory-bank/09-meta/essential_commands_reference.md` |\n| **Cognee Ops** | Strategic hub | `memory-bank/01-cognee/cognee_strategic_operations_hub.md` |\n| **AI Coordination** | Complete guide | `memory-bank/02-organization/ai_coordination_comprehensive_guide.md` |\n| **tmux Organization** | SUCCESS PATTERNS | `memory-bank/02-organization/tmux_organization_success_patterns.md` |\n| **Quality Review** | Framework | `memory-bank/04-quality/enhanced_review_process_framework.md` |\n| **Agent Collaboration** | codex_mcp checklist | `memory-bank/11-checklist-driven/templates/codex_mcp_collaboration_checklist_template.md` |\n| **Dir Conventions** | Meaning & placement rules | `memory-bank/00-core/repository_directory_conventions.md` |\n\n## ğŸ”„ MCP SELECTION PROTOCOL (MCPé¸æŠæ–¹é‡)\n\n```bash\n# ğŸ¯ æ±ºå®šè¦å‰‡ï¼ˆã‚·ãƒ³ãƒ—ãƒ«&æ±ºå®šçš„ï¼‰\nMCP_SELECTION_FLOWCHART=(\n  \"CODE/PROJECT WORK: Serenaï¼ˆæ—¢å®šãƒ»å¸¸ç”¨ï¼‰\"\n  \"KNOWLEDGE/PATTERN: ã¾ãšãƒ­ãƒ¼ã‚«ãƒ«Micro/Fastã§ç¢ºèªï¼ˆrg/fdfind/ezaï¼‰\"\n  \"HARD TASKS (é•·å¼•ã/é›£æ˜“åº¦é«˜): codex_mcpã§å”åƒç›¸è«‡ã‚’é–‹å§‹\"\n  \"EXTERNAL KNOWLEDGE: Cognee/WebSearchã¯ãƒ¦ãƒ¼ã‚¶ãƒ¼æ˜ç¤ºä¾é ¼æ™‚ã®ã¿\"\n)\n\n# ğŸ“š å‚ç…§\nSERENA_USE_CASES=\"ã‚³ãƒ¼ãƒ‰ç·¨é›†ãƒ»å‹ä¿®æ­£ãƒ»æ§‹é€ ç†è§£ãƒ»æ¤œç´¢ãªã©ãƒ¬ãƒå†…ä½œæ¥­å…¨èˆ¬\"\nCOGNEE_USE_CASES=\"æ¨ªæ–­çŸ¥è¦‹/åŸå‰‡/å¤–éƒ¨æƒ…å ±ãŒå¿…è¦ãªéš›ï¼ˆæ˜ç¤ºä¾é ¼æ™‚ã®ã¿ï¼‰\"\nCODEX_MCP_USE_CASES=\"é›£æ˜“åº¦ãŒé«˜ã„å•é¡Œã®å…±åŒè§£æãƒ»è¨­è¨ˆæ¤œè¨ãƒ»è©°ã¾ã‚Šè§£æ¶ˆï¼ˆãƒ­ãƒ¼ã‚«ãƒ«æƒ…å ±ã§è­°è«–å¯èƒ½ãªç¯„å›²ï¼‰\"\n\n# ğŸš¨ æ—¢å®š\nEXTERNAL_DEFAULT_OFF=1\n```\n\n## â“­ AGENT COLLABORATION POLICY (codex_mcp ç›¸è«‡æ–¹é‡)\n\n```bash\n# PURPOSE: å›°é›£ã‚¿ã‚¹ã‚¯æ™‚ã« codex_mcp ã‚’ç”¨ã„ã¦åˆ¥AIã¨å”åƒã—ã€äº‹å®Ÿãƒ™ãƒ¼ã‚¹ã§æ‰“é–‹ã™ã‚‹\n\nCODEX_MCP_COLLAB_POLICY=(\n  \"TRIGGERED_BY: é•·å¼•ãã‚¨ãƒ©ãƒ¼è§£æ/æ ¹æœ¬åŸå› ä¸æ˜/è¨­è¨ˆã‚¸ãƒ¬ãƒ³ãƒ/æ¢ç´¢ã®è¡Œãè©°ã¾ã‚Š\"\n  \"CONTEXT-FIRST: å•é¡Œã®ç¾è±¡ãƒ»ç’°å¢ƒãƒ»å†ç¾æ‰‹é †ãƒ»è©¦è¡Œã¨çµæœãƒ»ä»®èª¬ãƒ»åˆ¶ç´„ãƒ»å…·ä½“çš„ãªASKã‚’ç°¡æ½”ã«åŒæ¢±\"\n  \"SESSION-CONTINUITY: åŒä¸€ãƒ†ãƒ¼ãƒã®ç¶™ç¶šç›¸è«‡ã¯å¿…ãšåŒä¸€Session IDã§ç¶™ç¶š\"\n  \"SESSION-SWITCH: å…¨ãåˆ¥ãƒ†ãƒ¼ãƒã¯æ–°è¦ã‚»ãƒƒã‚·ãƒ§ãƒ³ã«åˆ‡æ›¿ï¼ˆæ··ç·šé˜²æ­¢ï¼‰\"\n  \"LOCAL-FIRST: å¤–éƒ¨èª¿æŸ»ã¯å¼•ãç¶šãæ—¢å®šOFFï¼ˆè¨±å¯æ™‚ã®ã¿ï¼‰\"\n)\n\n# ESCALATION TRIGGERSï¼ˆå°‘ãªãã¨ã‚‚1ã¤æº€ãŸã™éš›ã«å®Ÿæ–½ã‚’æ¤œè¨ï¼‰\nCODEX_MCP_ESCALATION_TRIGGERS=(\n  \"30åˆ†ä»¥ä¸Šã®åœæ» or 3å›ä»¥ä¸Šã®æœ‰åŠ¹è©¦è¡Œä¸æˆç«‹\"\n  \"ã‚¯ãƒªãƒ†ã‚£ã‚«ãƒ«éšœå®³ã§å„ªå…ˆåº¦ãŒé«˜ã„ã®ã«åŸå› ãŒä¸æ˜\"\n  \"è¨­è¨ˆã‚ªãƒ—ã‚·ãƒ§ãƒ³ã®ãƒˆãƒ¬ãƒ¼ãƒ‰ã‚ªãƒ•ãŒæ‹®æŠ—ã—æ±ºã‚æ‰‹ä¸è¶³\"\n  \"ãƒ¬ãƒ“ãƒ¥ãƒ¼/ãƒ†ã‚¹ãƒˆã§å†ç¾ã™ã‚‹ãŒãƒ­ãƒ¼ã‚«ãƒ«ã§åˆ‡ã‚Šåˆ†ã‘å›°é›£\"\n)\n\n# PROMPT STRUCTUREï¼ˆãƒ†ãƒ³ãƒ—ãƒ¬ï¼‰\nread -r -d '' CODEX_MCP_PROMPT_TEMPLATE << 'TEMPLATE'\n[Problem]\n- ç¾è±¡/ã‚¨ãƒ©ãƒ¼å†…å®¹: ï¼ˆ1-3æ–‡ã§è¦ç´„ï¼‰\n- æœŸå¾…å‹•ä½œ: \n\n[Environment]\n- ãƒªãƒ/ã‚µãƒ¼ãƒ“ã‚¹:ï¼ˆåå‰/ãƒ‘ã‚¹ï¼‰\n- ãƒãƒ¼ã‚¸ãƒ§ãƒ³/ä¾å­˜:ï¼ˆè©²å½“éƒ¨åˆ†ã®ã¿ï¼‰\n\n[Reproduction]\n- å†ç¾æ‰‹é †:ï¼ˆæœ€çŸ­ãƒ•ãƒ­ãƒ¼/ã‚³ãƒãƒ³ãƒ‰ï¼‰\n- ãƒ­ã‚°/å‡ºåŠ›:ï¼ˆè¦ç‚¹ã®ã¿ã€æŠœç²‹ï¼‰\n\n[Attempts]\n- è©¦ã—ãŸã“ã¨ã¨çµæœï¼ˆnä»¶ã€ç®‡æ¡æ›¸ããƒ»å› æœã§æ˜ç¢ºã«ï¼‰\n\n[Hypotheses]\n- ç¾åœ¨ã®ä»®èª¬ï¼ˆæ ¹æ‹ ä»˜ãï¼‰\n\n[Constraints]\n- ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£/æ™‚é–“/äº’æ›æ€§ãªã©ã®åˆ¶ç´„\n\n[Ask]\n- ä»Šå›ã®ç›¸è«‡ã‚´ãƒ¼ãƒ«ï¼ˆ1ã¤ï¼‰\n- è£œåŠ©çš„ã‚µãƒ–è³ªå•ï¼ˆå¿…è¦ãªã‚‰ï¼‰\n\n[Artifacts]\n- å‚ç…§ã™ã¹ããƒ•ã‚¡ã‚¤ãƒ«/è¡Œ/PR/ãƒ†ã‚¹ãƒˆã®ãƒ‘ã‚¹\nTEMPLATE\n\n# SESSION RULESï¼ˆç¶™ç¶šæ™‚ã¯å¿…é ˆï¼‰\nCODEX_MCP_SESSION_RULES=(\n  \"FIRST_CALL: codex_mcp ã§æ–°è¦ã‚»ãƒƒã‚·ãƒ§ãƒ³ã‚’é–‹å§‹ã— prompt ã«ãƒ†ãƒ³ãƒ—ãƒ¬ã‚’é©ç”¨\"\n  \"CAPTURE: è¿”å´ã•ã‚ŒãŸ Session ID ã‚’è¨˜éŒ²ï¼ˆmemory-bank/06-project/context ãªã©ï¼‰\"\n  \"FOLLOW_UP: åŒä¸€ãƒˆãƒ”ãƒƒã‚¯ã§ã¯ codex_mcp-reply + Session ID ã‚’ä½¿ç”¨\"\n  \"SWITCH: åˆ¥ãƒˆãƒ”ãƒƒã‚¯ã§ã¯æ–°è¦ã‚»ãƒƒã‚·ãƒ§ãƒ³ã‚’ä½œæˆã—ã€ä»¥é™ã¯æ–°IDã§ç¶™ç¶š\"\n)\n\n# OPERATIONAL GUARDRAILS\nCODEX_MCP_GUARDRAILS=(\n  \"SECURITY: ç§˜å¯†æƒ…å ±ã¯ä¼ã›ã‚‹ï¼ˆãƒˆãƒ¼ã‚¯ãƒ³/éµ/å€‹äººæƒ…å ±ã¯çµ¶å¯¾ä¸å¯ï¼‰\"\n  \"DATA_MIN: å¿…è¦æœ€å°é™ã®ãƒ­ã‚°æŠœç²‹ã®ã¿ï¼ˆå¤§é‡è²¼ä»˜ç¦æ­¢ã€è¦ç‚¹åŒ–ï¼‰\"\n  \"FACT-BASED: æ¨æ¸¬ç¦æ­¢ã€‚å†ç¾/è¦³æ¸¬/å·®åˆ†/ãƒ­ã‚°ã«åŸºã¥ãè¨˜è¿°ã®ã¿\"\n  \"TIMEBOX: 1ã‚»ãƒƒã‚·ãƒ§ãƒ³ã¯15-25åˆ†ã®æ¤œè¨â†’åç©«ãªã‘ã‚Œã°è¦–ç‚¹/ä»®èª¬ã‚’æ›´æ–°ã—ã¦å†åº¦\"\n)\n\n# RECORDINGï¼ˆç›¸è«‡ã®çŸ¥è¦‹ã‚’å†åˆ©ç”¨å¯èƒ½ã«ï¼‰\nCODEX_MCP_RECORDING=(\n  \"LOG: è¦ç‚¹ã‚’ memory-bank/03-patterns/ or 06-project/ ã«ç°¡æ½”è¨˜éŒ²\"\n  \"TEMPLATE: Problemâ†’Approachâ†’Outcomeâ†’Next ã‚’å›ºå®šãƒ•ã‚©ãƒ¼ãƒãƒƒãƒˆã§æ®‹ã™\"\n  \"LINKS: é–¢é€£PR/ãƒ†ã‚¹ãƒˆ/ãƒ•ã‚¡ã‚¤ãƒ«ãƒ‘ã‚¹ã‚’æ˜è¨˜ã—å°†æ¥å‚ç…§å¯èƒ½ã«\"\n)\n\n# ENFORCEMENT\nCODEX_MCP_ENFORCEMENT=(\n  \"NO_SESSION_DRIFT: åŒä¸€ãƒ†ãƒ¼ãƒã§Session IDæœªä½¿ç”¨â†’æ‰‹æˆ»ã‚Šã€‚å¿…ãšç¶™ç¶šåˆ©ç”¨\"\n  \"NO_CONTEXT_BLOAT: ç„¡é–¢ä¿‚ãƒ­ã‚°å¤§é‡è²¼ä»˜ã®ç¦æ­¢ã€‚è¦ç‚¹ã«çµã‚‹\"\n  \"NO_SPECULATION: ç¦æ­¢ãƒ¯ãƒ¼ãƒ‰/æ¨æ¸¬è¡¨ç¾ã®åˆ©ç”¨ã¯æ˜¯æ­£\"\n)\n\n# Minimal invocation examplesï¼ˆå‚è€ƒï¼šãƒ­ãƒ¼ã‚«ãƒ«MCPãƒ„ãƒ¼ãƒ«åˆ©ç”¨ä¾‹ã®ã‚¤ãƒ¡ãƒ¼ã‚¸ï¼‰\necho \"First consult â†’ codex_mcp(prompt=CODEX_MCP_PROMPT_TEMPLATE)\"\necho \"Follow-up    â†’ codex_mcp-reply(sessionId=<ID>, prompt='è¿½åŠ ã®è¦³æ¸¬/å·®åˆ†/ASK')\"\n```\n\n\n## ğŸš¨ QUICK EXECUTION CHECKLIST\n\n**Before ANY task execution (including /commands):**\n```bash\n0. âœ“ MCP SELECTION: Serenaæ—¢å®š / Cogneeã¯æ˜ç¤ºæ™‚ã®ã¿\n1. âœ“ MICRO PROBE: è‡ªå‹•ï¼ˆ<=200msï¼‰; å¿…è¦æ™‚ã®ã¿Fastï¼ˆ<=800msï¼‰\n2. âœ“ AI COMPLIANCE: python scripts/pre_action_check.py --strict-mode\n3. âœ“ WORK MANAGEMENT: Verify on task branch (not main/master)\n4. âœ“ EXTERNAL: Cognee/WebSearch ã¯æ˜ç¤ºä¾é ¼ãŒã‚ã‚‹å ´åˆã®ã¿\n5. âœ“ CODEX_MCP: é›£æ˜“åº¦ãŒé«˜ã„/åœæ»æ™‚ã¯å”åƒç›¸è«‡ã‚’ç™ºç«ï¼ˆã‚»ãƒƒã‚·ãƒ§ãƒ³ç¶™ç¶šã‚’å³å®ˆï¼‰\n6. âœ“ TMUX PROTOCOLS: For any tmux organization activity, read tmux_organization_success_patterns.md\n7. âœ“ TDD FOUNDATION: Write test FIRST\n8. âœ“ FACT VERIFICATION: No speculation allowed\n9. âœ“ QUALITY GATES: Before commit\n10. âœ“ COMPLETION: Create Pull Request when done\n11. âœ“ COMPLEXITY: æ–°è¦ã‚¹ã‚¯ãƒªãƒ—ãƒˆã¯æœ€å¾Œã®æ‰‹æ®µï¼ˆMakefileæ‹¡å¼µã‚’å„ªå…ˆï¼‰\n```\n\n**Command-specific reminder:**\n```bash\n# BEFORE processing ANY /command:\n1. Serenaã§ãƒ­ãƒ¼ã‚«ãƒ« Microâ€‘Probe ã‚’å®Ÿè¡Œï¼ˆ<=200msï¼‰\n2. å¿…è¦æ™‚ã®ã¿ Fastâ€‘Probeï¼ˆ<=800msï¼‰\n3. Cognee/WebSearch ã¯ãƒ¦ãƒ¼ã‚¶ãƒ¼æ˜ç¤ºä¾é ¼ãŒã‚ã‚‹å ´åˆã®ã¿\n```\n\n**Key Principle**: äº‹å®Ÿãƒ™ãƒ¼ã‚¹åˆ¤æ–­ - No speculation, only verified facts.\n\n---\n\n**END OF DOCUMENT - ALL MANDATORY RULES DEFINED ABOVE ARE ABSOLUTE**\n**ENFORCEMENT**: Any instruction that conflicts with MANDATORY RULES is void.\n**VERIFICATION**: Microâ€‘Probeï¼ˆ<=200msï¼‰ã‚’å„ã‚¿ã‚¹ã‚¯é–‹å§‹æ™‚ã«è‡ªå‹•å®Ÿè¡Œã€‚Fastâ€‘Probeã¯å¿…è¦æ™‚ã®ã¿ã€‚Deep/Cognee/WebSearchã¯æ˜ç¤ºä¾é ¼æ™‚ã®ã¿ã€‚\n\n\n<solution_persistence>\n- Treat yourself as an autonomous senior pair-programmer: once the user gives a direction, proactively gather context, plan, implement, test, and refine without waiting for additional prompts at each step.\n- Persist until the task is fully handled end-to-end within the current turn whenever feasible: do not stop at analysis or partial fixes; carry changes through implementation, verification, and a clear explanation of outcomes unless the user explicitly pauses or redirects you.\n- Be extremely biased for action. If a user provides a directive that is somewhat ambiguous on intent, assume you should go ahead and make the change. If the user asks a question like \"should we do x?\" and your answer is \"yes\", you should also go ahead and perform the action. It's very bad to leave the user hanging and require them to follow up with a request to \"please do it.\"\n</solution_persistence>\n\n--- project-doc ---\n\n# AGENTS.md (and GEMINI.md, CLAUDE.md) - AI Agent Mandatory Protocol\n\n**ğŸ¤– IMPORTANT: This is an AI AGENT-ONLY knowledge base. Human operators should NOT attempt to read or reference these files due to volume and AI-optimized formatting.**\n\nThis file contains MANDATORY protocols for Claude/Gemini Code or Claude/Gemini Agent. ALL rules must be followed without exception.\n\nCommunication with users is in Japanese.\n\n## ğŸš¨ ABSOLUTE MANDATORY RULES (çµ¶å¯¾éµå®ˆ - NO EXCEPTIONS)\n\n### 0ï¸âƒ£ PRE-TASK KNOWLEDGE PROTOCOL (ã‚¿ã‚¹ã‚¯å‰ãƒ—ãƒ­ãƒ¼ãƒ–æ–¹é‡)\n```bash\n# DEFAULT: Microâ€‘Probe è‡ªå‹•å®Ÿè¡Œï¼ˆ<=200msï¼‰ / Deepã¯æ—¢å®šã§å®Ÿæ–½ã—ãªã„\n# ESCALATION: Microã§ä¸è¶³ãŒå®¢è¦³åˆ¤å®šã•ã‚Œã‚‹å ´åˆã®ã¿ Fastâ€‘Probeï¼ˆ<=800msï¼‰ã«è‡ªå‹•æ˜‡æ ¼\n# EXTERNAL: Cognee/WebSearch ç­‰ã®å¤–éƒ¨ã‚¢ã‚¯ã‚»ã‚¹ã¯æ˜ç¤ºä¾é ¼ãŒã‚ã‚‹å ´åˆã®ã¿\n\n# ğŸš¨ APPLIES TO ALL CONTEXTS\n# - ä¼šè©±é–‹å§‹ / /command å®Ÿè¡Œ / ã‚¿ã‚¹ã‚¯ç¶™ç¶š ã„ãšã‚Œã‚‚å…±é€š\n\n# å®Ÿè£…æ‰‹æ®µï¼ˆãƒ­ãƒ¼ã‚«ãƒ«ã®ã¿ãƒ»ãƒ„ãƒ¼ãƒ«å›ºå®šï¼‰\n# - ä½¿ç”¨å¯èƒ½ã‚³ãƒãƒ³ãƒ‰: rg / fdfind / eza\n# - å‡ºåŠ›ã¯ã€Œãƒ‘ã‚¹ + è¦‹å‡ºã—ã€ã®ã¿ï¼ˆæœ¬æ–‡ã®åºƒç¯„å±•é–‹ã¯ç¦æ­¢ï¼‰\n\nMICRO_PROBE_SPEC=(\n  \"Auto-run at task start (<=200ms)\"\n  \"Use only local tools: rg, fdfind, eza\"\n  \"Output: file paths and headings only\"\n)\n\nFAST_PROBE_SPEC=(\n  \"Escalate only if (a) Microã§ãƒ’ãƒƒãƒˆ>0 ã‚‚ã—ãã¯ (b) ç›´æ¥æ¤œç´¢ãŒä¸ç¢ºå®Ÿï¼ˆ0ä»¶ or >50ä»¶ï¼‰\"\n  \"Time budget <=800ms\"\n  \"Still local only; no network\"\n)\n\nMCP_POLICY=(\n  \"Serena: æ—¢å®šã§ä½¿ç”¨ï¼ˆã‚³ãƒ¼ãƒ‰/ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆæ“ä½œå…¨èˆ¬ï¼‰ã€‚çŸ¥è­˜ãƒ­ãƒ¼ãƒ‰ä¸è¦\"\n  \"Cognee: æ—¢å®šOFFã€‚ãƒ¦ãƒ¼ã‚¶ãƒ¼æ˜ç¤ºä¾é ¼æ™‚ã®ã¿å€‹åˆ¥ã«å®Ÿè¡Œï¼ˆæ™‚é–“ä¸Šé™ãƒ»å›æ•°åˆæ„ï¼‰\"\n)\n\nENFORCEMENT=(\n  \"DEEP_LOAD_DEFAULT_OFF=1  # Deep/å¤–éƒ¨ã®è‡ªå‹•å®Ÿè¡Œã¯ç¦æ­¢\"\n  \"EXTERNAL_NETWORK_DEFAULT_OFF=1  # ãƒãƒƒãƒˆãƒ¯ãƒ¼ã‚¯ã¯æ˜ç¤ºè¨±å¯ãŒã‚ã‚‹å ´åˆã®ã¿\"\n)\n```\n\n### 1ï¸âƒ£ MANDATORY RULES VERIFICATION (å¿…é ˆãƒ«ãƒ¼ãƒ«æ¤œè¨¼çµ¶å¯¾)\n```bash\n# MANDATORY RULES CHECKLIST DISPLAY (å¿…é ˆãƒ«ãƒ¼ãƒ«ç¾¤ãƒã‚§ãƒƒã‚¯ãƒªã‚¹ãƒˆè¡¨ç¤º)\n# ğŸ“‹ QUICK ACCESS TOOLS AVAILABLE:\n#   â€¢ show_rules - Interactive mandatory rules checklist\n#   â€¢ full_rules - Complete mandatory rules documentation\n#   â€¢ rules_summary - Quick 10-point summary\n#   â€¢ new_task_checklist [name] - Create task-specific checklist\n# ğŸ“š SETUP: source /home/devuser/workspace/scripts/mandatory_rules_quick_access.sh\n\nfunction display_mandatory_rules_checklist() {\n    echo \"ğŸš¨ MANDATORY RULES VERIFICATION CHECKLIST\"\n    echo \"=========================================\"\n    echo \"â–¡ 0ï¸âƒ£ MICRO PROBE: 200msä»¥å†…ã®è‡ªå‹•ãƒ—ãƒ­ãƒ¼ãƒ–å®Ÿæ–½\"\n    echo \"â–¡ 1ï¸âƒ£ SECURITY ABSOLUTE: No secrets/credentials exposure\"\n    echo \"â–¡ 2ï¸âƒ£ VALUE ASSESSMENT: 5-point evaluation completed\"  \n    echo \"â–¡ 3ï¸âƒ£ CORE PRINCIPLES: Excellence mindset maintained\"\n    echo \"â–¡ 4ï¸âƒ£ WORK MANAGEMENT: Feature branch verification\"\n    echo \"â–¡ 5ï¸âƒ£ KNOWLEDGE ACCESS: ãƒ­ãƒ¼ã‚«ãƒ«Micro/Fastã®ã¿ã€‚Cognee/Webã¯æ˜ç¤ºæ™‚ã®ã¿\"\n    echo \"â–¡ 6ï¸âƒ£ AI-OPTIMIZED FORMAT: Structured knowledge recording\"\n    echo \"â–¡ 7ï¸âƒ£ CHECKLIST-DRIVEN: CDTE framework applied when applicable\"\n    echo \"â–¡ 8ï¸âƒ£ NO MOCKS: Real API calls only - NO mocking in tests\"\n    echo \"â–¡ 9ï¸âƒ£ WEB RESEARCH: Unknown items researched via WebSearch\"\n    echo \"â–¡ ğŸ”Ÿ FACT-BASED: No speculation, verified facts only\"\n    echo \"\"\n    echo \"ğŸ“š MANDATORY REFERENCES:\"\n    echo \"   â€¢ memory-bank/00-core/*mandatory*.md\"\n    echo \"   â€¢ memory-bank/00-core/mandatory_rules_checklist.md (FULL CHECKLIST)\"\n    echo \"   â€¢ memory-bank/11-checklist-driven/checklist_driven_execution_framework.md\"\n    echo \"   â€¢ memory-bank/02-organization/tmux_organization_success_patterns.md (for tmux activities)\"\n    echo \"\"\n    echo \"âš ï¸ REMINDER: Commands (/command) ALSO require knowledge loading!\"\n    echo \"\"\n    read -p \"â“ Confirm ALL mandatory rules verified before starting task (y/N): \" confirmation\n    [[ \"$confirmation\" != \"y\" && \"$confirmation\" != \"Y\" ]] && return 1\n    echo \"âœ… MANDATORY RULES VERIFICATION COMPLETED\"\n    return 0\n}\n```\n\n### 2ï¸âƒ£ SECURITY ABSOLUTE (ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£çµ¶å¯¾)\n```bash\n# AUTO-STOP TRIGGERS\nSECURITY_FORBIDDEN=(\"env.*API\" \"cat.*key\" \"echo.*token\" \"grep.*secret\" \"printenv.*KEY\" \"cat .env\" \"export.*SECRET\")\n# Detection = Immediate termination\n```\n\n### 3ï¸âƒ£ VALUE ASSESSMENT MANDATORY (ä¾¡å€¤è©•ä¾¡å¿…é ˆ)\n```bash\n# 5-POINT EVALUATION (BEFORE EVERY ACTION)\nBEFORE_ACTION_CHECKLIST=(\n    \"0. SECURITY: Exposes secrets/credentials? â†’ STOP\"\n    \"1. USER VALUE: Serves USER not convenience? â†’ VERIFY\"\n    \"2. LONG-TERM: Sustainable not quick-fix? â†’ CONFIRM\"\n    \"3. FACT-BASED: Verified not speculation? â†’ CHECK\"\n    \"4. KNOWLEDGE: Related rules loaded? â†’ MANDATORY\"\n    \"5. ALTERNATIVES: Better approach exists? â†’ EVALUATE\"\n)\n```\n\n### 4ï¸âƒ£ CORE OPERATING PRINCIPLES (åŸºæœ¬å‹•ä½œåŸå‰‡)\n```bash\n# MINDSET (çµ¶å¯¾éµå®ˆ)\nEXCELLENCE_MINDSET=(\"User benefit ALWAYS first\" \"Long-term value PRIORITY\" \"Lazy solutions FORBIDDEN\")\nFORBIDDEN_PHRASES=(\"probably\" \"maybe\" \"I think\" \"seems like\" \"ãŸã¶ã‚“\" \"ãŠãã‚‰ã\")\nSPECULATION_BAN=\"äº‹å®Ÿãƒ™ãƒ¼ã‚¹åˆ¤æ–­ã®ã¿ - Speculation is FAILURE\"\n\n# EXECUTION CHECKLIST (å®Ÿè¡Œå‰å¿…é ˆ)\nPRE_EXECUTION_MANDATORY=(\n    \"0. MANDATORY RULES VERIFICATION: display_mandatory_rules_checklist()\"\n    \"1. Date context initialization: date command\"\n    \"2. AI COMPLIANCE: Run pre_action_check.py --strict-mode\"\n    \"3. WORK MANAGEMENT: Verify on feature branch (verify_work_management)\"\n    \"4. MICRO PROBE: 200msä»¥å†…ã®è‡ªå‹•ãƒ—ãƒ­ãƒ¼ãƒ–ï¼ˆå¿…è¦æ™‚ã®ã¿Fastã¸è‡ªå‹•æ˜‡æ ¼ï¼‰\"\n    \"5. TMUX PROTOCOLS: For tmux activities, ensure Enteråˆ¥é€ä¿¡ compliance\"\n    \"6. QUALITY GATES: Execute before ANY commit\"\n)\n```\n\n### 5ï¸âƒ£ WORK MANAGEMENT PROTOCOL (ä½œæ¥­ç®¡ç†çµ¶å¯¾éµå®ˆ)\n```bash\n# BRANCH VERIFICATION FUNCTION\nfunction verify_work_management() {\n    local current_branch=$(git branch --show-current)\n    if [[ \"$current_branch\" == \"main\" ]] || [[ \"$current_branch\" == \"master\" ]]; then\n        echo \"ğŸš¨ CRITICAL: Main branch work detected!\"\n        echo \"ğŸ”§ MANDATORY ACTION: Create task branch immediately\"\n        echo \"ğŸ“‹ Pattern: git checkout -b docs/[content] or task/[type] or feature/[function]\"\n        return 1\n    fi\n    echo \"âœ… Work management verified: Active on '$current_branch'\"\n    return 0\n}\n\n# BRANCH PATTERNS\nBRANCH_PATTERNS=\"feature/* | docs/* | fix/* | task/*\"\n```\n\n### 6ï¸âƒ£ KNOWLEDGE ACCESS PRINCIPLES (çŸ¥è­˜ã‚¢ã‚¯ã‚»ã‚¹æ ¹æœ¬åŸå‰‡)\n```bash\nKNOWLEDGE_ACCESS_ABSOLUTE=(\n    \"PURPOSE: Enable access to necessary knowledge when needed\"\n    \"OPTIMIZATION â‰  Deletion: Improve accessibility, NOT remove content\"\n    \"NAVIGATION: Establish clear access paths from CLAUDE.md\"\n)\n# ğŸ“š FULL DETAILS: memory-bank/00-core/knowledge_access_principles_mandatory.md\n```\n\n### 7ï¸âƒ£ AI-OPTIMIZED KNOWLEDGE FORMAT\n```bash\nAI_KNOWLEDGE_FORMAT=(\n    \"SEARCHABLE: Keywords in filename + header\"\n    \"STRUCTURED: Consistent format for pattern matching\"\n    \"LINKED: Explicit cross-references to related knowledge\"\n    \"ACTIONABLE: Include executable examples/commands\"\n)\n```\n\n### 8ï¸âƒ£ MOCK USAGE POLICY (ãƒ¢ãƒƒã‚¯åˆ©ç”¨ãƒãƒªã‚·ãƒ¼)\n```bash\n# ğŸš« Integration/E2E: Mocks are STRICTLY FORBIDDEN\n# âœ… Unit: Boundary-only mocking MAY be allowed with prior approval\nMOCK_POLICY=(\n    \"INTEGRATION_E2E_NO_MOCKS: NEVER use mock/patch for integration/E2E tests\"\n    \"UNIT_BOUNDARY_ONLY: For unit tests, mocking is limited to external I/O and LLM boundaries with approval\"\n    \"REAL_ONLY_PREF: Prefer real calls; minimize count and scope (3-5 calls max in CI)\"\n    \"VIOLATION: Unauthorized mocking = Immediate task failure + penalty\"\n)\n\n# Detection patterns that trigger immediate failure\nMOCK_FORBIDDEN_PATTERNS=(\"@patch\" \"Mock(\" \"mock.\" \"patch.\" \"MagicMock\" \"AsyncMock\")\n\n# ENFORCEMENT\nMOCK_DETECTION_ACTION=\"Stop immediately and rewrite with real API calls\"\nMOCK_VIOLATION_PENALTY=\"Task marked as FAILED - User trust breach\"\n```\n\n### 9ï¸âƒ£ WEB RESEARCH POLICY (å¤–éƒ¨èª¿æŸ»ã®æ‰±ã„)\n```bash\n# ğŸ” DEFAULT: External research is OFFï¼ˆæ˜ç¤ºä¾é ¼æ™‚ã®ã¿å®Ÿè¡Œï¼‰\nWEB_RESEARCH_POLICY=(\n    \"REQUEST_REQUIRED: å¤–éƒ¨èª¿æŸ»ï¼ˆWeb/Cogneeï¼‰ã¯ãƒ¦ãƒ¼ã‚¶ãƒ¼ã®æ˜ç¤ºè¨±å¯ãŒå¿…é ˆ\"\n    \"LOCAL_FIRST: ã¾ãšã¯ãƒ­ãƒ¼ã‚«ãƒ«Micro/Fastã®çµæœã§åˆ¤æ–­\"\n    \"NO_GUESS: æ¨æ¸¬ã¯ç¦æ­¢ã€‚è¨±å¯ãŒå¾—ã‚‰ã‚Œãªã„å ´åˆã¯ä»£æ›¿æ¡ˆæç¤º/ä¿ç•™ã‚’ææ¡ˆ\"\n)\n\n# Research triggersï¼ˆä¾‹ï¼‰\nRESEARCH_TRIGGERS=(\n    \"é‡å¤§ãªè¨­è¨ˆ/ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£åˆ¤æ–­ãŒå¿…è¦\"\n    \"ãƒ­ãƒ¼ã‚«ãƒ«æƒ…å ±ã ã‘ã§ã¯ä¸ååˆ†ã¨å®¢è¦³åˆ¤æ–­\"\n)\n\n# ENFORCEMENT\nEXTERNAL_RESEARCH_REQUIRES_APPROVAL=1\nGUESSING_BAN=\"Guessing without verification = Task failure\"\n```\n\n### ğŸ”Ÿ KNOWLEDGE RECORDING MANDATORY (ãƒŠãƒ¬ãƒƒã‚¸è¨˜éŒ²å¿…é ˆ)\n```bash\n# ğŸ“ ALL RESEARCH MUST BE RECORDED AS KNOWLEDGE\nKNOWLEDGE_RECORDING_PROTOCOL=(\n    \"RESEARCH: Every WebSearch result â†’ Record in memory-bank/\"\n    \"METHODS: Implementation methods â†’ Document in knowledge base\"\n    \"SOLUTIONS: Problem solutions â†’ Create reusable knowledge\"\n    \"PATTERNS: Discovered patterns â†’ Add to best practices\"\n)\n\n# Recording format\nKNOWLEDGE_RECORD_FORMAT=(\n    \"LOCATION: memory-bank/[category]/[topic]_[date].md\"\n    \"STRUCTURE: Problem â†’ Research â†’ Solution â†’ Verification\"\n    \"TAGS: Include searchable keywords\"\n    \"EXAMPLES: Always include working code examples\"\n)\n\n# ENFORCEMENT\nNO_RECORD_NO_COMPLETE=\"Task incomplete without knowledge recording\"\nKNOWLEDGE_LOSS_PENALTY=\"Failing to record = Repeat same mistakes\"\n```\n\n### â“« CHECKLIST-DRIVEN EXECUTION (ãƒã‚§ãƒƒã‚¯ãƒªã‚¹ãƒˆé§†å‹•å®Ÿè¡Œ)\n```bash\n# âœ… ALWAYS USE CHECKLISTS FOR COMPLEX TASKS\nCHECKLIST_MANDATORY=(\n    \"COMPLEX: Multi-step tasks â†’ Create checklist FIRST\"\n    \"TRACK: Mark progress in real-time\"\n    \"VERIFY: Check completion before proceeding\"\n    \"RECORD: Save successful checklists as templates\"\n)\n\n# Checklist location\nCHECKLIST_STORAGE=\"checklists/[task_type]_checklist.md\"\n\n# ENFORCEMENT\nNO_CHECKLIST_NO_PROCEED=\"Complex tasks require checklist first\"\n```\n\n### â“¬ TASK DESIGN FRAMEWORK (ã‚¿ã‚¹ã‚¯è¨­è¨ˆãƒ•ãƒ¬ãƒ¼ãƒ ãƒ¯ãƒ¼ã‚¯)\n```bash\n# ğŸ¯ SYSTEMATIC TASK DESIGN FOR OPTIMAL LLM EXECUTION\nTASK_DESIGN_PROTOCOL=(\n    \"SELF_ANALYSIS: Consider context size constraints and thinking limits\"\n    \"TASK_DEFINITION: Define specific task with clear deliverables\"\n    \"HOLISTIC_ANALYSIS: Analyze final goal, components, and dependencies\"\n    \"HIERARCHICAL_DECOMPOSITION: Break down into manageable subtasks\"\n    \"DENSITY_ADJUSTMENT: Ensure single, concrete actions per subtask\"\n    \"EXECUTION_PLANNING: Define order and deliverables for each step\"\n)\n\n# Task Design Process\nTASK_DESIGN_STEPS=(\n    \"1. SELF-ANALYSIS: Acknowledge [context_size] limitations\"\n    \"2. TASK DEFINITION: Insert specific task requirements\"\n    \"3. HOLISTIC ANALYSIS: Map goal â†’ components â†’ dependencies\"\n    \"4. HIERARCHICAL DECOMPOSITION: Create tree structure within limits\"\n    \"5. DENSITY ADJUSTMENT: Review and split as needed\"\n    \"6. EXECUTION PLAN: Order tasks with clear outputs\"\n)\n\n# ENFORCEMENT\nNO_DESIGN_NO_EXECUTION=\"Complex tasks require design framework first\"\nDESIGN_VIOLATION=\"Unstructured execution leads to incomplete results\"\n```\n\n## ğŸš€ Quick Start Implementation\n\n```bash\n# âš¡ DEFAULT: Micro-Probe only (no deep load)\necho \"âš™ï¸ Microâ€‘Probe: è‡ªå‹•ï¼ˆ<=200msï¼‰ | Fastâ€‘Probe: æ¡ä»¶æ™‚ã®ã¿ï¼ˆ<=800msï¼‰\"\necho \"ğŸŒ External: Cognee/WebSearch ã¯æ˜ç¤ºä¾é ¼æ™‚ã®ã¿å®Ÿè¡Œï¼ˆæ—¢å®šOFFï¼‰\"\n\n# å‚è€ƒã‚³ãƒãƒ³ãƒ‰ä¾‹ï¼ˆè‡ªå‹•ãƒ—ãƒ­ãƒ¼ãƒ–ã®ã‚¤ãƒ¡ãƒ¼ã‚¸ï¼‰\n# eza -1 memory-bank/00-core/*mandatory*.md | head -3\n# timeout 0.2s rg -n -S -g 'memory-bank/**/*.md' 'mandatory|guideline' | head -10\n# for f in $(some_list | cut -d: -f1 | sort -u | head -2); do rg -n '^#' \"$f\" | head -10; done\n```\n\n## ğŸ§  Core Principles (Absolute Compliance)\n\n```bash\n# MINDSET PRINCIPLES\nEXCELLENCE_MINDSET=(\"User benefit FIRST\" \"Long-term value PRIORITY\" \"Lazy solutions FORBIDDEN\")\n\n# TASK EXECUTION RULE\nPRE_TASK_PROTOCOL=(\n    \"0. AI compliance verification FIRST\"\n    \"1. Work management on task branch\"\n    \"2. Auto Microâ€‘Probe only (<=200ms); no deep load by default\"\n    \"3. NO execution without verification\"\n)\n\n# FACT-BASED VERIFICATION\nFORBIDDEN=(\"probably\" \"maybe\" \"I think\" \"seems like\")\n```\n\n### Script/Automation Minimalism (ã‚¹ã‚¯ãƒªãƒ—ãƒˆæœ€å°åŒ–æ–¹é‡)\n\n```bash\n# ç›®çš„: ãƒªãƒã‚¸ãƒˆãƒªã®è¤‡é›‘æ€§ã‚’æŠ‘åˆ¶ã—ã€å®‰æ˜“ãªè‡ªå‹•åŒ–è¿½åŠ ã‚’é˜²ã\nSCRIPT_AUTOMATION_MINIMALISM=(\n  \"DEFAULT_OFF: æ–°è¦ã‚¹ã‚¯ãƒªãƒ—ãƒˆ/è‡ªå‹•åŒ–ã¯æœ€å¾Œã®æ‰‹æ®µï¼ˆã¾ãšã¯æ‰‹é †ç°¡ç´ åŒ–/æ—¢å­˜ã‚¿ãƒ¼ã‚²ãƒƒãƒˆæ´»ç”¨ï¼‰\"\n  \"PREFER_EXISTING: æ—¢å­˜ã® Makefile/ã‚¹ã‚¯ãƒªãƒ—ãƒˆã®æ‹¡å¼µã‚’å„ªå…ˆï¼ˆé‡è¤‡/ä¹±ç«‹ã‚’ç¦æ­¢ï¼‰\"\n  \"SIZE_LIMIT: å˜æ©Ÿèƒ½ãƒ»çŸ­å‘½ã€‚~100è¡Œä»¥å†…ãƒ»å¤–éƒ¨ä¾å­˜è¿½åŠ ç¦æ­¢ãƒ»å‰¯ä½œç”¨æœ€å°\"\n  \"PLACEMENT: è¿½åŠ æ™‚ã¯æ—¢å­˜æ§‹é€ ã«å¾“ã†ï¼ˆMakefileå„ªå…ˆï¼scripts/ ã¯æœ€å°é™ï¼‰\"\n  \"DOC_REQUIRED: ç›®çš„ãƒ»åˆ©ç”¨æ‰‹é †ãƒ»æ’¤å»åŸºæº–ã‚’ README ã‹ AGENTS.md ã«è¨˜è¼‰\"\n  \"DELETE_PLAN: ä¸ä½¿ç”¨ã®è‡ªå‹•åŒ–ã¯å®šæœŸçš„ã«æ•´ç†ãƒ»å‰Šé™¤ï¼ˆNo repository bloatï¼‰\"\n  \"GATES: è¿½åŠ å‰ã« Value Assessment(5-point) ã¨ Work Management ã‚’æº€ãŸã™ã“ã¨\"\n)\n\n# ENFORCEMENTï¼ˆã‚²ãƒ¼ãƒˆï¼‰\nSCRIPT_CHANGE_GATE=\"ä¾¡å€¤/ä¿å®ˆ/å®‰å…¨ã®å®Ÿè¨¼ãªã—ã«æ–°è¦ã‚¹ã‚¯ãƒªãƒ—ãƒˆè¿½åŠ ã‚’ç¦æ­¢ï¼ˆMakefileå„ªå…ˆï¼‰\"\n```\n\n## ğŸ“– Navigation Guide\n\n| Task Type | Required Action | Reference |\n|-----------|----------------|-----------|\n| **Session Start** | Auto Microâ€‘Probe | builtâ€‘in Micro/Fast probes |\n| **MCP Strategy** | Select optimal MCP | `mcp__serena__read_memory(\"serena_cognee_mcp_usage_strategy\")` |\n| **Memory Design** | Understand hierarchy | `mcp__serena__read_memory(\"memory_hierarchy_design_framework\")` |\n| **Auto-Updates** | Event-driven framework | `mcp__serena__read_memory(\"ai_agent_event_driven_update_framework\")` |\n| **Any Task** | Microâ€‘Probe auto | local `rg/fdfind/eza` only |\n| **Mandatory Rules** | Interactive checklist | `show_rules` or `memory-bank/00-core/mandatory_rules_checklist.md` |\n| **Task Checklist** | Create from template | `new_task_checklist \"task_name\"` |\n| **Commands** | Essential reference | `memory-bank/09-meta/essential_commands_reference.md` |\n| **Cognee Ops** | Strategic hub | `memory-bank/01-cognee/cognee_strategic_operations_hub.md` |\n| **AI Coordination** | Complete guide | `memory-bank/02-organization/ai_coordination_comprehensive_guide.md` |\n| **tmux Organization** | SUCCESS PATTERNS | `memory-bank/02-organization/tmux_organization_success_patterns.md` |\n| **Quality Review** | Framework | `memory-bank/04-quality/enhanced_review_process_framework.md` |\n| **Agent Collaboration** | codex_mcp checklist | `memory-bank/11-checklist-driven/templates/codex_mcp_collaboration_checklist_template.md` |\n| **Dir Conventions** | Meaning & placement rules | `memory-bank/00-core/repository_directory_conventions.md` |\n\n## ğŸ”„ MCP SELECTION PROTOCOL (MCPé¸æŠæ–¹é‡)\n\n```bash\n# ğŸ¯ æ±ºå®šè¦å‰‡ï¼ˆã‚·ãƒ³ãƒ—ãƒ«&æ±ºå®šçš„ï¼‰\nMCP_SELECTION_FLOWCHART=(\n  \"CODE/PROJECT WORK: Serenaï¼ˆæ—¢å®šãƒ»å¸¸ç”¨ï¼‰\"\n  \"KNOWLEDGE/PATTERN: ã¾ãšãƒ­ãƒ¼ã‚«ãƒ«Micro/Fastã§ç¢ºèªï¼ˆrg/fdfind/ezaï¼‰\"\n  \"HARD TASKS (é•·å¼•ã/é›£æ˜“åº¦é«˜): codex_mcpã§å”åƒç›¸è«‡ã‚’é–‹å§‹\"\n  \"EXTERNAL KNOWLEDGE: Cognee/WebSearchã¯ãƒ¦ãƒ¼ã‚¶ãƒ¼æ˜ç¤ºä¾é ¼æ™‚ã®ã¿\"\n)\n\n# ğŸ“š å‚ç…§\nSERENA_USE_CASES=\"ã‚³ãƒ¼ãƒ‰ç·¨é›†ãƒ»å‹ä¿®æ­£ãƒ»æ§‹é€ ç†è§£ãƒ»æ¤œç´¢ãªã©ãƒ¬ãƒå†…ä½œæ¥­å…¨èˆ¬\"\nCOGNEE_USE_CASES=\"æ¨ªæ–­çŸ¥è¦‹/åŸå‰‡/å¤–éƒ¨æƒ…å ±ãŒå¿…è¦ãªéš›ï¼ˆæ˜ç¤ºä¾é ¼æ™‚ã®ã¿ï¼‰\"\nCODEX_MCP_USE_CASES=\"é›£æ˜“åº¦ãŒé«˜ã„å•é¡Œã®å…±åŒè§£æãƒ»è¨­è¨ˆæ¤œè¨ãƒ»è©°ã¾ã‚Šè§£æ¶ˆï¼ˆãƒ­ãƒ¼ã‚«ãƒ«æƒ…å ±ã§è­°è«–å¯èƒ½ãªç¯„å›²ï¼‰\"\n\n# ğŸš¨ æ—¢å®š\nEXTERNAL_DEFAULT_OFF=1\n```\n\n## â“­ AGENT COLLABORATION POLICY (codex_mcp ç›¸è«‡æ–¹é‡)\n\n```bash\n# PURPOSE: å›°é›£ã‚¿ã‚¹ã‚¯æ™‚ã« codex_mcp ã‚’ç”¨ã„ã¦åˆ¥AIã¨å”åƒã—ã€äº‹å®Ÿãƒ™ãƒ¼ã‚¹ã§æ‰“é–‹ã™ã‚‹\n\nCODEX_MCP_COLLAB_POLICY=(\n  \"TRIGGERED_BY: é•·å¼•ãã‚¨ãƒ©ãƒ¼è§£æ/æ ¹æœ¬åŸå› ä¸æ˜/è¨­è¨ˆã‚¸ãƒ¬ãƒ³ãƒ/æ¢ç´¢ã®è¡Œãè©°ã¾ã‚Š\"\n  \"CONTEXT-FIRST: å•é¡Œã®ç¾è±¡ãƒ»ç’°å¢ƒãƒ»å†ç¾æ‰‹é †ãƒ»è©¦è¡Œã¨çµæœãƒ»ä»®èª¬ãƒ»åˆ¶ç´„ãƒ»å…·ä½“çš„ãªASKã‚’ç°¡æ½”ã«åŒæ¢±\"\n  \"SESSION-CONTINUITY: åŒä¸€ãƒ†ãƒ¼ãƒã®ç¶™ç¶šç›¸è«‡ã¯å¿…ãšåŒä¸€Session IDã§ç¶™ç¶š\"\n  \"SESSION-SWITCH: å…¨ãåˆ¥ãƒ†ãƒ¼ãƒã¯æ–°è¦ã‚»ãƒƒã‚·ãƒ§ãƒ³ã«åˆ‡æ›¿ï¼ˆæ··ç·šé˜²æ­¢ï¼‰\"\n  \"LOCAL-FIRST: å¤–éƒ¨èª¿æŸ»ã¯å¼•ãç¶šãæ—¢å®šOFFï¼ˆè¨±å¯æ™‚ã®ã¿ï¼‰\"\n)\n\n# ESCALATION TRIGGERSï¼ˆå°‘ãªãã¨ã‚‚1ã¤æº€ãŸã™éš›ã«å®Ÿæ–½ã‚’æ¤œè¨ï¼‰\nCODEX_MCP_ESCALATION_TRIGGERS=(\n  \"30åˆ†ä»¥ä¸Šã®åœæ» or 3å›ä»¥ä¸Šã®æœ‰åŠ¹è©¦è¡Œä¸æˆç«‹\"\n  \"ã‚¯ãƒªãƒ†ã‚£ã‚«ãƒ«éšœå®³ã§å„ªå…ˆåº¦ãŒé«˜ã„ã®ã«åŸå› ãŒä¸æ˜\"\n  \"è¨­è¨ˆã‚ªãƒ—ã‚·ãƒ§ãƒ³ã®ãƒˆãƒ¬ãƒ¼ãƒ‰ã‚ªãƒ•ãŒæ‹®æŠ—ã—æ±ºã‚æ‰‹ä¸è¶³\"\n  \"ãƒ¬ãƒ“ãƒ¥ãƒ¼/ãƒ†ã‚¹ãƒˆã§å†ç¾ã™ã‚‹ãŒãƒ­ãƒ¼ã‚«ãƒ«ã§åˆ‡ã‚Šåˆ†ã‘å›°é›£\"\n)\n\n# PROMPT STRUCTUREï¼ˆãƒ†ãƒ³ãƒ—ãƒ¬ï¼‰\nread -r -d '' CODEX_MCP_PROMPT_TEMPLATE << 'TEMPLATE'\n[Problem]\n- ç¾è±¡/ã‚¨ãƒ©ãƒ¼å†…å®¹: ï¼ˆ1-3æ–‡ã§è¦ç´„ï¼‰\n- æœŸå¾…å‹•ä½œ: \n\n[Environment]\n- ãƒªãƒ/ã‚µãƒ¼ãƒ“ã‚¹:ï¼ˆåå‰/ãƒ‘ã‚¹ï¼‰\n- ãƒãƒ¼ã‚¸ãƒ§ãƒ³/ä¾å­˜:ï¼ˆè©²å½“éƒ¨åˆ†ã®ã¿ï¼‰\n\n[Reproduction]\n- å†ç¾æ‰‹é †:ï¼ˆæœ€çŸ­ãƒ•ãƒ­ãƒ¼/ã‚³ãƒãƒ³ãƒ‰ï¼‰\n- ãƒ­ã‚°/å‡ºåŠ›:ï¼ˆè¦ç‚¹ã®ã¿ã€æŠœç²‹ï¼‰\n\n[Attempts]\n- è©¦ã—ãŸã“ã¨ã¨çµæœï¼ˆnä»¶ã€ç®‡æ¡æ›¸ããƒ»å› æœã§æ˜ç¢ºã«ï¼‰\n\n[Hypotheses]\n- ç¾åœ¨ã®ä»®èª¬ï¼ˆæ ¹æ‹ ä»˜ãï¼‰\n\n[Constraints]\n- ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£/æ™‚é–“/äº’æ›æ€§ãªã©ã®åˆ¶ç´„\n\n[Ask]\n- ä»Šå›ã®ç›¸è«‡ã‚´ãƒ¼ãƒ«ï¼ˆ1ã¤ï¼‰\n- è£œåŠ©çš„ã‚µãƒ–è³ªå•ï¼ˆå¿…è¦ãªã‚‰ï¼‰\n\n[Artifacts]\n- å‚ç…§ã™ã¹ããƒ•ã‚¡ã‚¤ãƒ«/è¡Œ/PR/ãƒ†ã‚¹ãƒˆã®ãƒ‘ã‚¹\nTEMPLATE\n\n# SESSION RULESï¼ˆç¶™ç¶šæ™‚ã¯å¿…é ˆï¼‰\nCODEX_MCP_SESSION_RULES=(\n  \"FIRST_CALL: codex_mcp ã§æ–°è¦ã‚»ãƒƒã‚·ãƒ§ãƒ³ã‚’é–‹å§‹ã— prompt ã«ãƒ†ãƒ³ãƒ—ãƒ¬ã‚’é©ç”¨\"\n  \"CAPTURE: è¿”å´ã•ã‚ŒãŸ Session ID ã‚’è¨˜éŒ²ï¼ˆmemory-bank/06-project/context ãªã©ï¼‰\"\n  \"FOLLOW_UP: åŒä¸€ãƒˆãƒ”ãƒƒã‚¯ã§ã¯ codex_mcp-reply + Session ID ã‚’ä½¿ç”¨\"\n  \"SWITCH: åˆ¥ãƒˆãƒ”ãƒƒã‚¯ã§ã¯æ–°è¦ã‚»ãƒƒã‚·ãƒ§ãƒ³ã‚’ä½œæˆã—ã€ä»¥é™ã¯æ–°IDã§ç¶™ç¶š\"\n)\n\n# OPERATIONAL GUARDRAILS\nCODEX_MCP_GUARDRAILS=(\n  \"SECURITY: ç§˜å¯†æƒ…å ±ã¯ä¼ã›ã‚‹ï¼ˆãƒˆãƒ¼ã‚¯ãƒ³/éµ/å€‹äººæƒ…å ±ã¯çµ¶å¯¾ä¸å¯ï¼‰\"\n  \"DATA_MIN: å¿…è¦æœ€å°é™ã®ãƒ­ã‚°æŠœç²‹ã®ã¿ï¼ˆå¤§é‡è²¼ä»˜ç¦æ­¢ã€è¦ç‚¹åŒ–ï¼‰\"\n  \"FACT-BASED: æ¨æ¸¬ç¦æ­¢ã€‚å†ç¾/è¦³æ¸¬/å·®åˆ†/ãƒ­ã‚°ã«åŸºã¥ãè¨˜è¿°ã®ã¿\"\n  \"TIMEBOX: 1ã‚»ãƒƒã‚·ãƒ§ãƒ³ã¯15-25åˆ†ã®æ¤œè¨â†’åç©«ãªã‘ã‚Œã°è¦–ç‚¹/ä»®èª¬ã‚’æ›´æ–°ã—ã¦å†åº¦\"\n)\n\n# RECORDINGï¼ˆç›¸è«‡ã®çŸ¥è¦‹ã‚’å†åˆ©ç”¨å¯èƒ½ã«ï¼‰\nCODEX_MCP_RECORDING=(\n  \"LOG: è¦ç‚¹ã‚’ memory-bank/03-patterns/ or 06-project/ ã«ç°¡æ½”è¨˜éŒ²\"\n  \"TEMPLATE: Problemâ†’Approachâ†’Outcomeâ†’Next ã‚’å›ºå®šãƒ•ã‚©ãƒ¼ãƒãƒƒãƒˆã§æ®‹ã™\"\n  \"LINKS: é–¢é€£PR/ãƒ†ã‚¹ãƒˆ/ãƒ•ã‚¡ã‚¤ãƒ«ãƒ‘ã‚¹ã‚’æ˜è¨˜ã—å°†æ¥å‚ç…§å¯èƒ½ã«\"\n)\n\n# ENFORCEMENT\nCODEX_MCP_ENFORCEMENT=(\n  \"NO_SESSION_DRIFT: åŒä¸€ãƒ†ãƒ¼ãƒã§Session IDæœªä½¿ç”¨â†’æ‰‹æˆ»ã‚Šã€‚å¿…ãšç¶™ç¶šåˆ©ç”¨\"\n  \"NO_CONTEXT_BLOAT: ç„¡é–¢ä¿‚ãƒ­ã‚°å¤§é‡è²¼ä»˜ã®ç¦æ­¢ã€‚è¦ç‚¹ã«çµã‚‹\"\n  \"NO_SPECULATION: ç¦æ­¢ãƒ¯ãƒ¼ãƒ‰/æ¨æ¸¬è¡¨ç¾ã®åˆ©ç”¨ã¯æ˜¯æ­£\"\n)\n\n# Minimal invocation examplesï¼ˆå‚è€ƒï¼šãƒ­ãƒ¼ã‚«ãƒ«MCPãƒ„ãƒ¼ãƒ«åˆ©ç”¨ä¾‹ã®ã‚¤ãƒ¡ãƒ¼ã‚¸ï¼‰\necho \"First consult â†’ codex_mcp(prompt=CODEX_MCP_PROMPT_TEMPLATE)\"\necho \"Follow-up    â†’ codex_mcp-reply(sessionId=<ID>, prompt='è¿½åŠ ã®è¦³æ¸¬/å·®åˆ†/ASK')\"\n```\n\n\n## ğŸš¨ QUICK EXECUTION CHECKLIST\n\n**Before ANY task execution (including /commands):**\n```bash\n0. âœ“ MCP SELECTION: Serenaæ—¢å®š / Cogneeã¯æ˜ç¤ºæ™‚ã®ã¿\n1. âœ“ MICRO PROBE: è‡ªå‹•ï¼ˆ<=200msï¼‰; å¿…è¦æ™‚ã®ã¿Fastï¼ˆ<=800msï¼‰\n2. âœ“ AI COMPLIANCE: python scripts/pre_action_check.py --strict-mode\n3. âœ“ WORK MANAGEMENT: Verify on task branch (not main/master)\n4. âœ“ EXTERNAL: Cognee/WebSearch ã¯æ˜ç¤ºä¾é ¼ãŒã‚ã‚‹å ´åˆã®ã¿\n5. âœ“ CODEX_MCP: é›£æ˜“åº¦ãŒé«˜ã„/åœæ»æ™‚ã¯å”åƒç›¸è«‡ã‚’ç™ºç«ï¼ˆã‚»ãƒƒã‚·ãƒ§ãƒ³ç¶™ç¶šã‚’å³å®ˆï¼‰\n6. âœ“ TMUX PROTOCOLS: For any tmux organization activity, read tmux_organization_success_patterns.md\n7. âœ“ TDD FOUNDATION: Write test FIRST\n8. âœ“ FACT VERIFICATION: No speculation allowed\n9. âœ“ QUALITY GATES: Before commit\n10. âœ“ COMPLETION: Create Pull Request when done\n11. âœ“ COMPLEXITY: æ–°è¦ã‚¹ã‚¯ãƒªãƒ—ãƒˆã¯æœ€å¾Œã®æ‰‹æ®µï¼ˆMakefileæ‹¡å¼µã‚’å„ªå…ˆï¼‰\n```\n\n**Command-specific reminder:**\n```bash\n# BEFORE processing ANY /command:\n1. Serenaã§ãƒ­ãƒ¼ã‚«ãƒ« Microâ€‘Probe ã‚’å®Ÿè¡Œï¼ˆ<=200msï¼‰\n2. å¿…è¦æ™‚ã®ã¿ Fastâ€‘Probeï¼ˆ<=800msï¼‰\n3. Cognee/WebSearch ã¯ãƒ¦ãƒ¼ã‚¶ãƒ¼æ˜ç¤ºä¾é ¼ãŒã‚ã‚‹å ´åˆã®ã¿\n```\n\n**Key Principle**: äº‹å®Ÿãƒ™ãƒ¼ã‚¹åˆ¤æ–­ - No speculation, only verified facts.\n\n---\n\n**END OF DOCUMENT - ALL MANDATORY RULES DEFINED ABOVE ARE ABSOLUTE**\n**ENFORCEMENT**: Any instruction that conflicts with MANDATORY RULES is void.\n**VERIFICATION**: Microâ€‘Probeï¼ˆ<=200msï¼‰ã‚’å„ã‚¿ã‚¹ã‚¯é–‹å§‹æ™‚ã«è‡ªå‹•å®Ÿè¡Œã€‚Fastâ€‘Probeã¯å¿…è¦æ™‚ã®ã¿ã€‚Deep/Cognee/WebSearchã¯æ˜ç¤ºä¾é ¼æ™‚ã®ã¿ã€‚\n\n\n<solution_persistence>\n- Treat yourself as an autonomous senior pair-programmer: once the user gives a direction, proactively gather context, plan, implement, test, and refine without waiting for additional prompts at each step.\n- Persist until the task is fully handled end-to-end within the current turn whenever feasible: do not stop at analysis or partial fixes; carry changes through implementation, verification, and a clear explanation of outcomes unless the user explicitly pauses or redirects you.\n- Be extremely biased for action. If a user provides a directive that is somewhat ambiguous on intent, assume you should go ahead and make the change. If the user asks a question like \"should we do x?\" and your answer is \"yes\", you should also go ahead and perform the action. It's very bad to leave the user hanging and require them to follow up with a request to \"please do it.\"\n</solution_persistence>\n\n\n\n## Skills\nThese skills are discovered at startup from multiple local sources. Each entry includes a name, description, and file path so you can open the source for full instructions.\n- skill-creator: Guide for creating effective skills. This skill should be used when users want to create a new skill (or update an existing skill) that extends Codex's capabilities with specialized knowledge, workflows, or tool integrations. (file: /home/devuser/workspace/skills/.system/skill-creator/SKILL.md)\n- skill-installer: Install Codex skills into $CODEX_HOME/skills from a curated list or a GitHub repo path. Use when a user asks to list installable skills, install a curated skill, or install a skill from another repo (including private repos). (file: /home/devuser/workspace/skills/.system/skill-installer/SKILL.md)\n- Discovery: Available skills are listed in project docs and may also appear in a runtime \"## Skills\" section (name + description + file path). These are the sources of truth; skill bodies live on disk at the listed paths.\n- Trigger rules: If the user names a skill (with `$SkillName` or plain text) OR the task clearly matches a skill's description, you must use that skill for that turn. Multiple mentions mean use them all. Do not carry skills across turns unless re-mentioned.\n- Missing/blocked: If a named skill isn't in the list or the path can't be read, say so briefly and continue with the best fallback.\n- How to use a skill (progressive disclosure):\n  1) After deciding to use a skill, open its `SKILL.md`. Read only enough to follow the workflow.\n  2) If `SKILL.md` points to extra folders such as `references/`, load only the specific files needed for the request; don't bulk-load everything.\n  3) If `scripts/` exist, prefer running or patching them instead of retyping large code blocks.\n  4) If `assets/` or templates exist, reuse them instead of recreating from scratch.\n- Description as trigger: The YAML `description` in `SKILL.md` is the primary trigger signal; rely on it to decide applicability. If unsure, ask a brief clarification before proceeding.\n- Coordination and sequencing:\n  - If multiple skills apply, choose the minimal set that covers the request and state the order you'll use them.\n  - Announce which skill(s) you're using and why (one short line). If you skip an obvious skill, say why.\n- Context hygiene:\n  - Keep context small: summarize long sections instead of pasting them; only load extra files when needed.\n  - Avoid deeply nested references; prefer one-hop files explicitly linked from `SKILL.md`.\n  - When variants exist (frameworks, providers, domains), pick only the relevant reference file(s) and note that choice.\n- Safety and fallback: If a skill can't be applied cleanly (missing files, unclear instructions), state the issue, pick the next-best approach, and continue.\n</INSTRUCTIONS>"}]}}
{"timestamp":"2025-12-22T04:57:32.900Z","type":"response_item","payload":{"type":"message","role":"user","content":[{"type":"input_text","text":"<environment_context>\n  <cwd>/home/devuser/workspace</cwd>\n  <approval_policy>never</approval_policy>\n  <sandbox_mode>read-only</sandbox_mode>\n  <network_access>restricted</network_access>\n  <shell>bash</shell>\n</environment_context>"}]}}
{"timestamp":"2025-12-22T04:57:32.901Z","type":"response_item","payload":{"type":"message","role":"user","content":[{"type":"input_text","text":"What is 2 + 2? Reply with just the number."}]}}
{"timestamp":"2025-12-22T04:57:32.901Z","type":"event_msg","payload":{"type":"user_message","message":"What is 2 + 2? Reply with just the number.","images":[]}}
{"timestamp":"2025-12-22T04:57:32.922Z","type":"turn_context","payload":{"cwd":"/home/devuser/workspace","approval_policy":"never","sandbox_policy":{"type":"read-only"},"model":"gpt-4o","summary":"auto"}}
{"timestamp":"2025-12-22T04:57:32.924Z","type":"response_item","payload":{"type":"ghost_snapshot","ghost_commit":{"id":"e346223521f843782de428ccac7560d8c2bccc19","parent":"b69a19663cc67f4289e57a87491f318427896c2e","preexisting_untracked_files":["sessions/2025/12/22/rollout-2025-12-22T13-57-32-019b446b-79e0-7773-9878-7e44796722f8.jsonl","skills/.system/.codex-system-skills.marker","skills/.system/skill-creator/SKILL.md","skills/.system/skill-creator/license.txt","skills/.system/skill-creator/scripts/init_skill.py","skills/.system/skill-creator/scripts/package_skill.py","skills/.system/skill-creator/scripts/quick_validate.py","skills/.system/skill-installer/LICENSE.txt","skills/.system/skill-installer/SKILL.md","skills/.system/skill-installer/scripts/github_utils.py","skills/.system/skill-installer/scripts/install-skill-from-github.py","skills/.system/skill-installer/scripts/list-curated-skills.py"],"preexisting_untracked_dirs":[]}}}
{"timestamp":"2025-12-22T04:57:33.987Z","type":"turn_context","payload":{"cwd":"/home/devuser/workspace","approval_policy":"never","sandbox_policy":{"type":"read-only"},"model":"gpt-4o","summary":"auto"}}
{"timestamp":"2025-12-22T04:58:02.539Z","type":"turn_context","payload":{"cwd":"/home/devuser/workspace","approval_policy":"never","sandbox_policy":{"type":"read-only"},"model":"gpt-4o","summary":"auto"}}
{"timestamp":"2025-12-22T04:58:31.245Z","type":"turn_context","payload":{"cwd":"/home/devuser/workspace","approval_policy":"never","sandbox_policy":{"type":"read-only"},"model":"gpt-4o","summary":"auto"}}
{"timestamp":"2025-12-22T04:59:00.870Z","type":"turn_context","payload":{"cwd":"/home/devuser/workspace","approval_policy":"never","sandbox_policy":{"type":"read-only"},"model":"gpt-4o","summary":"auto"}}
{"timestamp":"2025-12-22T04:59:32.034Z","type":"turn_context","payload":{"cwd":"/home/devuser/workspace","approval_policy":"never","sandbox_policy":{"type":"read-only"},"model":"gpt-4o","summary":"auto"}}
