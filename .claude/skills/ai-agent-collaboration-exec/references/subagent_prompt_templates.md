# サブエージェント依頼テンプレート

## Pipeline 設計（必須）
- 既定パイプラインの踏襲は禁止。タスクに合わせて初期/動的ステージを設計し、理由と最適化観点を /draft.proposal に記録する。
- 動的追加が必要な場合は `allow_dynamic_stages: true` を前提にし、`next_stages` 追加条件を明記する。
- Reviewer はパイプライン設計がタスク最適化されていない場合、/critique で **NG** と明示する。

## Executor
- 役割: Executor（実ファイル変更とテスト実行）
- 目的: <目的/期待成果>
- 対象: <対象リポ/対象パス>
- 書き込み範囲: <許可パスのみ>
- 制約: 機密情報を扱わない、破壊的コマンドを避ける、事実ベースで記録する
- 記録先: /facts と /revise
- 成果物契約出力: `references/contract_output.md` に従う

## Reviewer
- 役割: Reviewer（独立レビュー）
- 実行: 読み取りのみ
- 書き込み範囲: <review_output_dir> のみ
- 記録先: /critique
- 要求: 指摘・リスク・未解決事項を根拠付きで列挙する（パイプライン設計の適合性も含む）

## Verifier
- 役割: Verifier（再実行/再現確認）
- 実行: テスト/CI を再実行して結果を確認
- 書き込み範囲: 原則なし（必要時は /facts の追記のみ）
- 記録先: /facts
- 要求: 失敗時は原因と次の一手を明確化する

## Releaser（任意）
- 役割: Releaser（commit/PR などの運用作業）
- 実行: git commit/push/PR 作成（必要時のみ）
- 書き込み範囲: <review_output_dir>（運用記録）
- 記録先: /facts
- 要求: 実行コマンドと結果、PR/コミット情報を簡潔に記録する

## Timeout Policy
- タスク難易度や要求水準を下げない。
- timeout が発生したら、同一スコープで再実行する（再実行上限を明示）。
- 再実行しても進められない場合は、タスクを停止しフレームワークのデバッグ/改善に移行する。
