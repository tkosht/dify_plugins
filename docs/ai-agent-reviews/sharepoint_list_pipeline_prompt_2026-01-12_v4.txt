ROLE: Parent agent orchestration for sharepoint_list doc-code-test consistency audit
DATE: 2026-01-12

STRICT NO-TOOLS RULE
- Do NOT call any tools or run any commands.
- Use ONLY the FACTS INPUT below. If evidence is missing, mark as 不明.
- Output JSON ONLY (single-line JSON; no line breaks anywhere).

OUTPUT FORMAT (MANDATORY)
- Required keys: schema_version, stage_id, status, output_is_partial, capsule_patch.
- /facts is an array of objects. Each object must include item, evidence, source, status.
- /draft /critique /revise must be objects. /open_questions and /assumptions are arrays.
- Do NOT include next_stages.
- All string values must be single-line and must not contain newline or \n.
- Avoid double quotes inside string values.

OBJECTIVE
- app/sharepoint_list のドキュメント・コード・テストの相互整合性を、根拠付きで一致/不一致/不明として整理する

CHECK ITEMS (exactly 3)
1) Tool parameters consistency (README vs tool YAML vs tool impl)
2) Filters spec consistency (README + design doc vs filters.py + operations.py + tests)
3) select_fields consistency (README vs operations.py + tests)

FACTS INPUT (EVIDENCE ONLY)

[Tool parameters]
- README tools list with parameters: create_item list_url + fields_json; update_item list_url + item_id + fields_json; get_item list_url + item_id + select_fields optional; list_items list_url required with optional select_fields filters page_size page_token and createdDateTime desc fixed; get_choices list_url + field_identifier: app/sharepoint_list/README.md:12-17
- create_item.yaml parameters list_url required string, fields_json required string: app/sharepoint_list/tools/create_item.yaml:12-34
- update_item.yaml parameters list_url required, item_id required, fields_json required: app/sharepoint_list/tools/update_item.yaml:13-44
- get_item.yaml parameters list_url required, item_id required, select_fields optional: app/sharepoint_list/tools/get_item.yaml:13-44
- list_items.yaml parameters list_url required; select_fields optional; page_size optional default 20 max 100; page_token optional; filters optional JSON field/op/value/type; createdDateTime exact casing: app/sharepoint_list/tools/list_items.yaml:8-96
- get_choices.yaml parameters list_url required, field_identifier required: app/sharepoint_list/tools/get_choices.yaml:13-34
- list_items.py uses list_url, select_fields, page_token, page_size default 20 max 100, filters; rejects created_after/created_before: app/sharepoint_list/tools/list_items.py:49-83
- get_item.py requires item_id and uses parse_select_fields: app/sharepoint_list/tools/get_item.py:41-53
- create_item.py parses fields_json; update_item.py requires item_id and parses fields_json: app/sharepoint_list/tools/create_item.py:41-52; app/sharepoint_list/tools/update_item.py:41-53
- get_choices.py requires field_identifier: app/sharepoint_list/tools/get_choices.py:47-56

[Filters spec]
- README filters: JSON array or object string; keys field op value required; type optional; ops eq ne gt ge lt le contains startswith endswith; createdDateTime top-level; displayName resolved to internal; unknown field causes GraphError: app/sharepoint_list/README.md:38-85
- Design doc: same keys and ops; createdDateTime top-level, other fields use fields/<internalName>; displayName to internal; datetime quoting rules; AND join; Prefer header HonorNonIndexedQueriesWarning=true for fields filters: docs/03.detail_design/sharepoint_list_list_items_filters.md:7-73
- filters.py ALLOWED_OPS list; parse_filters requires field and op; format_odata_value leaves datetime unquoted; build_filter_fragment quotes datetime when mapped_field starts with fields/ and uses createdDateTime top-level as is: app/sharepoint_list/internal/filters.py:7-67; 70-106
- operations.list_items maps createdDateTime to top-level and others to fields/<name>; uses Prefer header when fields/ in filter; orderby createdDateTime desc: app/sharepoint_list/internal/operations.py:760-798
- tests verify createdDateTime top-level, fields/ prefix, displayName resolution, Prefer header, and-join: tests/sharepoint_list/test_operations_filters.py:156-418
- tests verify JSON array/object, operators, datetime quoting: tests/sharepoint_list/test_filters.py:8-85

[select_fields]
- README select_fields: comma separated; removes outer quotes and per-field quotes; unknown field causes GraphError; missing fields filled with None and OData__ variants: app/sharepoint_list/README.md:31-36
- operations.parse_select_fields removes quotes; _validate_requested_fields raises GraphError for unknown; list_items fills missing fields and OData__ alias: app/sharepoint_list/internal/operations.py:346-361; 386-421; 908-951
- tests cover quote removal, displayName resolution, missing fields fill: tests/sharepoint_list/test_operations_select.py:50-501

